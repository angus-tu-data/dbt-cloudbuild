[0m16:31:56.128038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dce780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fdd30>]}


============================== 16:31:56.129768 | 521e0867-7b9f-43c6-80a1-bd644093948b ==============================
[0m16:31:56.129768 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:31:56.130011 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'introspect': 'True', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/angus/.dbt', 'printer_width': '80', 'target_path': 'None'}
[0m16:31:57.482268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10722d670>]}
[0m16:31:57.509132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d1cd0>]}
[0m16:31:57.509473 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:31:57.640375 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:31:57.640717 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:31:57.640867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fdb5730>]}
[0m16:31:58.055191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x178507860>]}
[0m16:31:58.080743 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:31:58.081730 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:31:58.090784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1786aaf90>]}
[0m16:31:58.090955 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:31:58.091076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x178563320>]}
[0m16:31:58.091667 [info ] [MainThread]: 
[0m16:31:58.091787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:58.091878 [info ] [MainThread]: 
[0m16:31:58.092053 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:58.093367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m16:31:58.093525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:58.647441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now create_tw-rd-data-angus-tu_dbt_dev)
[0m16:31:58.648403 [debug] [ThreadPool]: Creating schema "database: "tw-rd-data-angus-tu"
schema: "dbt_dev"
"
[0m16:31:58.661082 [debug] [ThreadPool]: On create_tw-rd-data-angus-tu_dbt_dev: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "connection_name": "create_tw-rd-data-angus-tu_dbt_dev"} */
create schema if not exists `tw-rd-data-angus-tu`.`dbt_dev`
  
[0m16:31:58.661608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:59.152875 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f42339b1-fdd8-4813-8ae0-43978ce58ea5&page=queryresults
[0m16:32:01.780685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_tw-rd-data-angus-tu_dbt_dev, now list_tw-rd-data-angus-tu_dbt_dev)
[0m16:32:01.781048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:02.009892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x178665e20>]}
[0m16:32:02.010784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:02.014968 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_first_dbt_model
[0m16:32:02.015720 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev.my_first_dbt_model ........................ [RUN]
[0m16:32:02.016203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.my_first_dbt_model)
[0m16:32:02.016582 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_first_dbt_model
[0m16:32:02.025833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_first_dbt_model"
[0m16:32:02.027103 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_first_dbt_model
[0m16:32:02.052184 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_first_dbt_model"
[0m16:32:02.052929 [debug] [Thread-1 (]: On model.dbt_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_first_dbt_model"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:32:02.053159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:02.530239 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:d33fe536-9bb9-4f9c-8ac1-d6f60c63e2e4&page=queryresults
[0m16:32:03.996144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1786a98e0>]}
[0m16:32:03.996923 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev.my_first_dbt_model ................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 1.98s]
[0m16:32:03.997433 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_first_dbt_model
[0m16:32:03.998209 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_second_dbt_model
[0m16:32:03.998701 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_dev.my_second_dbt_model ........................ [RUN]
[0m16:32:03.999186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.my_first_dbt_model, now model.dbt_demo.my_second_dbt_model)
[0m16:32:03.999521 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_second_dbt_model
[0m16:32:04.001989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_second_dbt_model"
[0m16:32:04.002647 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_second_dbt_model
[0m16:32:04.014872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_second_dbt_model"
[0m16:32:04.015401 [debug] [Thread-1 (]: On model.dbt_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_second_dbt_model"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id = 1;


[0m16:32:04.015624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:04.580154 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:9186dc1b-a9f0-41aa-9238-182228261da1&page=queryresults
[0m16:32:04.758628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '521e0867-7b9f-43c6-80a1-bd644093948b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17c3d2120>]}
[0m16:32:04.759287 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_dev.my_second_dbt_model ................... [[32mCREATE VIEW (0 processed)[0m in 0.76s]
[0m16:32:04.759794 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_second_dbt_model
[0m16:32:04.760763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:04.761253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:04.761495 [debug] [MainThread]: Connection 'model.dbt_demo.my_second_dbt_model' was properly closed.
[0m16:32:04.761734 [info ] [MainThread]: 
[0m16:32:04.761992 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m16:32:04.762945 [debug] [MainThread]: Command end result
[0m16:32:04.783249 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:32:04.784608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:32:04.788722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:32:04.789039 [info ] [MainThread]: 
[0m16:32:04.789352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:04.789524 [info ] [MainThread]: 
[0m16:32:04.789684 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:32:04.791260 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.692045, "process_in_blocks": "0", "process_kernel_time": 0.699383, "process_mem_max_rss": "428523520", "process_out_blocks": "0", "process_user_time": 4.639312}
[0m16:32:04.791540 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:04.791483 after 8.69 seconds
[0m16:32:04.791751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f3e2f90>]}
[0m16:32:04.791957 [debug] [MainThread]: Flushing usage events
[0m16:32:05.642577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:20.241565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf6c00>]}


============================== 16:32:20.243613 | b939e1de-c686-452c-9ab3-da4c2fba390e ==============================
[0m16:32:20.243613 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:32:20.243910 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'warn_error': 'None', 'invocation_command': 'dbt test', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'profiles_dir': '/Users/angus/.dbt', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m16:32:21.604318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fcc0c80>]}
[0m16:32:21.629200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed9280>]}
[0m16:32:21.629447 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:32:21.734321 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:32:21.781217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:21.781377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:21.793572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f7e2930>]}
[0m16:32:21.817193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:32:21.818234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:32:21.832532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x3008cecc0>]}
[0m16:32:21.832770 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:32:21.832910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fbddee0>]}
[0m16:32:21.833611 [info ] [MainThread]: 
[0m16:32:21.833746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:21.833834 [info ] [MainThread]: 
[0m16:32:21.834013 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:32:21.835362 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m16:32:21.835499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:22.171139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b939e1de-c686-452c-9ab3-da4c2fba390e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fbddd60>]}
[0m16:32:22.171773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:22.175391 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:32:22.175908 [info ] [Thread-1 (]: 1 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:32:22.176364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:32:22.176695 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:32:22.194531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:32:22.195425 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:32:22.208912 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:32:22.209732 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:32:22.209958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:23.011889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:41d770ae-de8e-4510-8bc4-8c2afe8923c0&page=queryresults
[0m16:32:23.423352 [error] [Thread-1 (]: 1 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.25s]
[0m16:32:23.424267 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:32:23.424687 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:32:23.425177 [info ] [Thread-1 (]: 2 of 3 START test not_null_my_first_dbt_model_message .......................... [RUN]
[0m16:32:23.425678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9)
[0m16:32:23.425958 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:32:23.430768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:32:23.431795 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:32:23.434741 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:32:23.435519 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where message is null



  
  
      
    ) dbt_internal_test
[0m16:32:23.435770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:23.699280 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2ce9554c-5d50-4f0f-9e41-5f365c77ded8&page=queryresults
[0m16:32:23.700537 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2ce9554c-5d50-4f0f-9e41-5f365c77ded8&page=queryresults
[0m16:32:23.713727 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:32:23.714773 [error] [Thread-1 (]: 2 of 3 ERROR not_null_my_first_dbt_model_message ............................... [[31mERROR[0m in 0.29s]
[0m16:32:23.715472 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:32:23.715872 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:32:23.716294 [debug] [Thread-4 (]: Marking all children of 'test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql.
[0m16:32:23.716749 [info ] [Thread-1 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:32:23.718336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9, now test.dbt_demo.unique_my_first_dbt_model_id.16e066b321)
[0m16:32:23.718781 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:32:23.725390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:32:23.726117 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:32:23.729355 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:32:23.729848 [debug] [Thread-1 (]: On test.dbt_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:32:23.730109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:24.236557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:455f1884-04d9-4d09-9840-b8f2fb71c27d&page=queryresults
[0m16:32:24.572397 [info ] [Thread-1 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.85s]
[0m16:32:24.573140 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:32:24.574734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:24.575382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:24.575652 [debug] [MainThread]: Connection 'test.dbt_demo.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:32:24.575947 [info ] [MainThread]: 
[0m16:32:24.576238 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m16:32:24.577236 [debug] [MainThread]: Command end result
[0m16:32:24.593139 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:32:24.594247 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:32:24.597310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:32:24.597836 [info ] [MainThread]: 
[0m16:32:24.598129 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:32:24.598378 [info ] [MainThread]: 
[0m16:32:24.598607 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:32:24.598757 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:32:24.598864 [info ] [MainThread]: 
[0m16:32:24.598980 [info ] [MainThread]:   compiled code at target/compiled/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:32:24.599080 [info ] [MainThread]: 
[0m16:32:24.599192 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_message (models/example/schema.yml)[0m
[0m16:32:24.599307 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:32:24.599401 [info ] [MainThread]: 
[0m16:32:24.599506 [info ] [MainThread]:   compiled code at target/compiled/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:32:24.599599 [info ] [MainThread]: 
[0m16:32:24.599719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m16:32:24.601071 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.3900013, "process_in_blocks": "0", "process_kernel_time": 0.780845, "process_mem_max_rss": "415334400", "process_out_blocks": "0", "process_user_time": 3.9509}
[0m16:32:24.601287 [debug] [MainThread]: Command `dbt test` failed at 16:32:24.601249 after 4.39 seconds
[0m16:32:24.601472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a891700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x300894ec0>]}
[0m16:32:24.601631 [debug] [MainThread]: Flushing usage events
[0m16:32:25.483425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:17.124090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e6660>]}


============================== 16:33:17.125918 | c7a3c07e-c555-4ef6-99d4-6f794f62605a ==============================
[0m16:33:17.125918 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:33:17.126150 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --full-refresh', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/angus/.dbt', 'indirect_selection': 'eager'}
[0m16:33:18.569966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aca090>]}
[0m16:33:18.597624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168dc1580>]}
[0m16:33:18.597986 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:33:18.700861 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:33:18.751802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:18.751953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:18.764107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168ff84d0>]}
[0m16:33:18.786938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:18.787838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:18.797298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1695e4740>]}
[0m16:33:18.797476 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:33:18.797605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1695b18b0>]}
[0m16:33:18.798215 [info ] [MainThread]: 
[0m16:33:18.798345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:18.798440 [info ] [MainThread]: 
[0m16:33:18.798608 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:18.799915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m16:33:18.800054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:19.339886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m16:33:19.340586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:19.519587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168eb4dd0>]}
[0m16:33:19.520473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:19.524169 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_first_dbt_model
[0m16:33:19.524815 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev.my_first_dbt_model ........................ [RUN]
[0m16:33:19.525273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.my_first_dbt_model)
[0m16:33:19.525616 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_first_dbt_model
[0m16:33:19.535706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_first_dbt_model"
[0m16:33:19.536515 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_first_dbt_model
[0m16:33:19.547289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:19.767659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_first_dbt_model"
[0m16:33:19.768660 [debug] [Thread-1 (]: On model.dbt_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_first_dbt_model"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:33:20.152187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:57234f16-7929-4f95-8d31-8cfa9cfa894b&page=queryresults
[0m16:33:21.909719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15888e870>]}
[0m16:33:21.910224 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev.my_first_dbt_model ................... [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.38s]
[0m16:33:21.910593 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_first_dbt_model
[0m16:33:21.911101 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_second_dbt_model
[0m16:33:21.911445 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_dev.my_second_dbt_model ........................ [RUN]
[0m16:33:21.911797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.my_first_dbt_model, now model.dbt_demo.my_second_dbt_model)
[0m16:33:21.912023 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_second_dbt_model
[0m16:33:21.913946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_second_dbt_model"
[0m16:33:21.914395 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_second_dbt_model
[0m16:33:21.925047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_second_dbt_model"
[0m16:33:21.925492 [debug] [Thread-1 (]: On model.dbt_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_second_dbt_model"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id = 1;


[0m16:33:21.925686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:22.229917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:225b53b4-5f94-4505-b728-d70540043f68&page=queryresults
[0m16:33:22.476117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7a3c07e-c555-4ef6-99d4-6f794f62605a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169a5bef0>]}
[0m16:33:22.477008 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_dev.my_second_dbt_model ................... [[32mCREATE VIEW (0 processed)[0m in 0.56s]
[0m16:33:22.477591 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_second_dbt_model
[0m16:33:22.478787 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:22.479425 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:22.479719 [debug] [MainThread]: Connection 'model.dbt_demo.my_second_dbt_model' was properly closed.
[0m16:33:22.480039 [info ] [MainThread]: 
[0m16:33:22.480391 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m16:33:22.481209 [debug] [MainThread]: Command end result
[0m16:33:22.501169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:22.502523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:22.506330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:33:22.506615 [info ] [MainThread]: 
[0m16:33:22.506973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:22.507159 [info ] [MainThread]: 
[0m16:33:22.507346 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:33:22.508997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4153934, "process_in_blocks": "0", "process_kernel_time": 0.768236, "process_mem_max_rss": "416628736", "process_out_blocks": "0", "process_user_time": 4.217649}
[0m16:33:22.509271 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:22.509216 after 5.42 seconds
[0m16:33:22.509476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e48aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169a5bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8ce60>]}
[0m16:33:22.509666 [debug] [MainThread]: Flushing usage events
[0m16:33:23.427016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:41.209371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dafce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a453290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a452f30>]}


============================== 16:33:41.211422 | d5241db8-16fe-4281-b452-4588626d9c36 ==============================
[0m16:33:41.211422 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:33:41.211670 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/Users/angus/.dbt', 'warn_error': 'None', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m16:33:42.386711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30bd14440>]}
[0m16:33:42.412137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb3470>]}
[0m16:33:42.412386 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:33:42.513841 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:33:42.560599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:42.560760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:42.572956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4865d0>]}
[0m16:33:42.596276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:42.597202 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:42.610564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30c9ceed0>]}
[0m16:33:42.610747 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:33:42.610873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30be54380>]}
[0m16:33:42.611547 [info ] [MainThread]: 
[0m16:33:42.611679 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:42.611773 [info ] [MainThread]: 
[0m16:33:42.611956 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:42.613284 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m16:33:42.613416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:42.872137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5241db8-16fe-4281-b452-4588626d9c36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30bcbbbc0>]}
[0m16:33:42.872563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:42.875431 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:33:42.875746 [info ] [Thread-1 (]: 1 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:33:42.876068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:33:42.876283 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:33:42.889355 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:33:42.889848 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:33:42.900576 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:33:42.900934 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:33:42.901135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:43.397983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8877db3c-f8f7-44c1-b923-24908fb8bf89&page=queryresults
[0m16:33:43.775748 [error] [Thread-1 (]: 1 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.90s]
[0m16:33:43.776454 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:33:43.776774 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:33:43.777155 [info ] [Thread-1 (]: 2 of 3 START test not_null_my_first_dbt_model_message .......................... [RUN]
[0m16:33:43.777586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9)
[0m16:33:43.777891 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:33:43.782070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:33:43.782841 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:33:43.784819 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:33:43.785357 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where message is null



  
  
      
    ) dbt_internal_test
[0m16:33:43.785638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:44.114724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:eb170509-4916-499d-b1a3-8bc46e94dca7&page=queryresults
[0m16:33:44.115865 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:eb170509-4916-499d-b1a3-8bc46e94dca7&page=queryresults
[0m16:33:44.129998 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:33:44.131078 [error] [Thread-1 (]: 2 of 3 ERROR not_null_my_first_dbt_model_message ............................... [[31mERROR[0m in 0.35s]
[0m16:33:44.131714 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:33:44.132087 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:33:44.132564 [debug] [Thread-4 (]: Marking all children of 'test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql.
[0m16:33:44.132950 [info ] [Thread-1 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:33:44.134179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9, now test.dbt_demo.unique_my_first_dbt_model_id.16e066b321)
[0m16:33:44.134524 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:33:44.140030 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:33:44.141020 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:33:44.144557 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:33:44.145060 [debug] [Thread-1 (]: On test.dbt_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:33:44.145314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:44.629878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:9754b1cd-f8fb-4538-8894-87943032169a&page=queryresults
[0m16:33:45.220931 [info ] [Thread-1 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.09s]
[0m16:33:45.221569 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:33:45.222698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:45.223250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:45.223500 [debug] [MainThread]: Connection 'test.dbt_demo.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:33:45.223824 [info ] [MainThread]: 
[0m16:33:45.224170 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m16:33:45.224969 [debug] [MainThread]: Command end result
[0m16:33:45.238786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:45.239894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:45.243752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:33:45.243926 [info ] [MainThread]: 
[0m16:33:45.244102 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:33:45.244242 [info ] [MainThread]: 
[0m16:33:45.244408 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m16:33:45.244567 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:33:45.244684 [info ] [MainThread]: 
[0m16:33:45.244826 [info ] [MainThread]:   compiled code at target/compiled/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m16:33:45.244947 [info ] [MainThread]: 
[0m16:33:45.245091 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_message (models/example/schema.yml)[0m
[0m16:33:45.245244 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_message (models/example/schema.yml)
  Unrecognized name: message at [18:7]
  compiled code at target/run/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:33:45.245364 [info ] [MainThread]: 
[0m16:33:45.245503 [info ] [MainThread]:   compiled code at target/compiled/dbt_demo/models/example/schema.yml/not_null_my_first_dbt_model_message.sql
[0m16:33:45.245623 [info ] [MainThread]: 
[0m16:33:45.245766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m16:33:45.247153 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.0669174, "process_in_blocks": "0", "process_kernel_time": 0.444983, "process_mem_max_rss": "419577856", "process_out_blocks": "0", "process_user_time": 4.484689}
[0m16:33:45.247396 [debug] [MainThread]: Command `dbt test` failed at 16:33:45.247351 after 4.07 seconds
[0m16:33:45.247581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecadb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d3830>]}
[0m16:33:45.247750 [debug] [MainThread]: Flushing usage events
[0m16:33:46.079567 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:51.433145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef6930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef65a0>]}


============================== 16:33:51.434924 | b394d178-576d-4bca-a10c-afe0f1148415 ==============================
[0m16:33:51.434924 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:33:51.435172 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'profiles_dir': '/Users/angus/.dbt', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'no_print': 'None', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs'}
[0m16:33:52.423543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d23290>]}
[0m16:33:52.449324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d8b26f0>]}
[0m16:33:52.449552 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:33:52.541779 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:33:52.579232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:33:52.579494 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/example/my_first_dbt_model.sql
[0m16:33:52.734868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f7e69c0>]}
[0m16:33:52.758171 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:52.758916 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:52.763935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x301ccf290>]}
[0m16:33:52.764100 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:33:52.764223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f300800>]}
[0m16:33:52.764824 [info ] [MainThread]: 
[0m16:33:52.764953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:33:52.765045 [info ] [MainThread]: 
[0m16:33:52.765211 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:52.766564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m16:33:52.766716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:53.439654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m16:33:53.440474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:53.580210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f1870b0>]}
[0m16:33:53.581077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:53.584203 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_first_dbt_model
[0m16:33:53.584879 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev.my_first_dbt_model ........................ [RUN]
[0m16:33:53.585348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.my_first_dbt_model)
[0m16:33:53.585681 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_first_dbt_model
[0m16:33:53.592367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_first_dbt_model"
[0m16:33:53.593116 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_first_dbt_model
[0m16:33:53.603354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:53.771153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_first_dbt_model"
[0m16:33:53.771782 [debug] [Thread-1 (]: On model.dbt_demo.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_first_dbt_model"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
      
    
    

    
    OPTIONS()
    as (
      


select
    1 as id,
    'hello dbt' as message
    );
  
[0m16:33:54.148299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:9b754cae-1060-4e2c-a544-b3cff7f163ef&page=queryresults
[0m16:33:55.576958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30b74a0c0>]}
[0m16:33:55.577401 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev.my_first_dbt_model ................... [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 1.99s]
[0m16:33:55.577740 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_first_dbt_model
[0m16:33:55.578150 [debug] [Thread-1 (]: Began running node model.dbt_demo.my_second_dbt_model
[0m16:33:55.578521 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_dev.my_second_dbt_model ........................ [RUN]
[0m16:33:55.578757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.my_first_dbt_model, now model.dbt_demo.my_second_dbt_model)
[0m16:33:55.578983 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.my_second_dbt_model
[0m16:33:55.580732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.my_second_dbt_model"
[0m16:33:55.581142 [debug] [Thread-1 (]: Began executing node model.dbt_demo.my_second_dbt_model
[0m16:33:55.591607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.my_second_dbt_model"
[0m16:33:55.592044 [debug] [Thread-1 (]: On model.dbt_demo.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.my_second_dbt_model"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id = 1;


[0m16:33:55.592224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:55.993951 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:201a471d-d01d-4405-9113-7a66839c3ad1&page=queryresults
[0m16:33:56.170065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b394d178-576d-4bca-a10c-afe0f1148415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30b7260f0>]}
[0m16:33:56.171175 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_dev.my_second_dbt_model ................... [[32mCREATE VIEW (0 processed)[0m in 0.59s]
[0m16:33:56.171750 [debug] [Thread-1 (]: Finished running node model.dbt_demo.my_second_dbt_model
[0m16:33:56.173250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:56.174004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:56.174323 [debug] [MainThread]: Connection 'model.dbt_demo.my_second_dbt_model' was properly closed.
[0m16:33:56.174626 [info ] [MainThread]: 
[0m16:33:56.174936 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m16:33:56.175707 [debug] [MainThread]: Command end result
[0m16:33:56.193336 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:33:56.194435 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:33:56.197566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:33:56.197738 [info ] [MainThread]: 
[0m16:33:56.197938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:56.198087 [info ] [MainThread]: 
[0m16:33:56.198245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m16:33:56.199528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7956953, "process_in_blocks": "0", "process_kernel_time": 0.295485, "process_mem_max_rss": "427606016", "process_out_blocks": "0", "process_user_time": 4.74065}
[0m16:33:56.199793 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:56.199745 after 4.80 seconds
[0m16:33:56.199975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066afe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30b6bca70>]}
[0m16:33:56.200152 [debug] [MainThread]: Flushing usage events
[0m16:33:57.015989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:59.736811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105317920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647e270>]}


============================== 16:33:59.738580 | 2772fcad-41dc-4299-bd83-44a3d82cd366 ==============================
[0m16:33:59.738580 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m16:33:59.738816 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'empty': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'profiles_dir': '/Users/angus/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'no_print': 'None'}
[0m16:34:00.825109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d1f10>]}
[0m16:34:00.850214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433f7140>]}
[0m16:34:00.850433 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m16:34:00.943658 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m16:34:00.980202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:00.980347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:00.992853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641b7d0>]}
[0m16:34:01.016424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:34:01.017131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:34:01.025321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1452d1d60>]}
[0m16:34:01.025504 [info ] [MainThread]: Found 2 models, 3 data tests, 508 macros
[0m16:34:01.025623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14529c3e0>]}
[0m16:34:01.026261 [info ] [MainThread]: 
[0m16:34:01.026394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:01.026493 [info ] [MainThread]: 
[0m16:34:01.026674 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:01.028000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m16:34:01.028145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:01.309268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2772fcad-41dc-4299-bd83-44a3d82cd366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ac3320>]}
[0m16:34:01.310113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:01.313140 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:34:01.313656 [info ] [Thread-1 (]: 1 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:34:01.314128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:34:01.314466 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:34:01.330097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:34:01.330728 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:34:01.341899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:34:01.342256 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where id is null



  
  
      
    ) dbt_internal_test
[0m16:34:01.342457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:01.727249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:1aa208b1-7dab-4175-a7d8-08242a1b64b6&page=queryresults
[0m16:34:02.041367 [info ] [Thread-1 (]: 1 of 3 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.73s]
[0m16:34:02.042314 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:34:02.042781 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:34:02.043297 [info ] [Thread-1 (]: 2 of 3 START test not_null_my_first_dbt_model_message .......................... [RUN]
[0m16:34:02.043844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9)
[0m16:34:02.044243 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:34:02.049708 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:34:02.050811 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:34:02.053372 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"
[0m16:34:02.054046 [debug] [Thread-1 (]: On test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message
from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
where message is null



  
  
      
    ) dbt_internal_test
[0m16:34:02.054384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:02.430924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:9db2ecfa-0e89-4d54-9a31-a2bb80cd0f12&page=queryresults
[0m16:34:02.786341 [info ] [Thread-1 (]: 2 of 3 PASS not_null_my_first_dbt_model_message ................................ [[32mPASS[0m in 0.74s]
[0m16:34:02.787130 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9
[0m16:34:02.787558 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:34:02.788032 [info ] [Thread-1 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:34:02.788520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_my_first_dbt_model_message.d8f19629f9, now test.dbt_demo.unique_my_first_dbt_model_id.16e066b321)
[0m16:34:02.788890 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:34:02.796963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:34:02.798267 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:34:02.802988 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"
[0m16:34:02.803718 [debug] [Thread-1 (]: On test.dbt_demo.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:34:02.804055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:03.263648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e93e2571-1e0b-4c16-8d77-383ae221d96a&page=queryresults
[0m16:34:03.579533 [info ] [Thread-1 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m16:34:03.580657 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_my_first_dbt_model_id.16e066b321
[0m16:34:03.581821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:03.582358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:03.582594 [debug] [MainThread]: Connection 'test.dbt_demo.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:34:03.582839 [info ] [MainThread]: 
[0m16:34:03.583078 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m16:34:03.583806 [debug] [MainThread]: Command end result
[0m16:34:03.599664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m16:34:03.600896 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m16:34:03.604790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m16:34:03.604969 [info ] [MainThread]: 
[0m16:34:03.605165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:34:03.605316 [info ] [MainThread]: 
[0m16:34:03.605477 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:34:03.606837 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.8991728, "process_in_blocks": "0", "process_kernel_time": 0.674259, "process_mem_max_rss": "419250176", "process_out_blocks": "0", "process_user_time": 4.263952}
[0m16:34:03.607132 [debug] [MainThread]: Command `dbt test` succeeded at 16:34:03.607079 after 3.90 seconds
[0m16:34:03.607337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dd9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ac1310>]}
[0m16:34:03.607520 [debug] [MainThread]: Flushing usage events
[0m16:34:04.441630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:20.459809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106abff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef30b0>]}


============================== 17:11:20.462352 | a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5 ==============================
[0m17:11:20.462352 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:11:20.462625 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/angus/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False'}
[0m17:11:21.737863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655e1520>]}
[0m17:11:21.762803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166247d40>]}
[0m17:11:21.763035 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:11:21.861949 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:11:21.910234 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
[0m17:11:21.910431 [debug] [MainThread]: Partial parsing: added file: dbt_demo://models/staging/member_G1.sql
[0m17:11:21.910576 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/schema.yml
[0m17:11:21.910691 [debug] [MainThread]: Partial parsing: deleted file: dbt_demo://models/example/my_second_dbt_model.sql
[0m17:11:21.910779 [debug] [MainThread]: Partial parsing: deleted file: dbt_demo://models/example/my_first_dbt_model.sql
[0m17:11:22.101792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo.example
[0m17:11:22.104993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166cd9040>]}
[0m17:11:22.132002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:11:22.133022 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:11:22.143016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167a8d2e0>]}
[0m17:11:22.143197 [info ] [MainThread]: Found 1 model, 4 data tests, 1 source, 508 macros
[0m17:11:22.143319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166f36ae0>]}
[0m17:11:22.143946 [info ] [MainThread]: 
[0m17:11:22.144074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:22.144170 [info ] [MainThread]: 
[0m17:11:22.144366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:11:22.144729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m17:11:22.144870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:22.686737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m17:11:22.687507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:22.901300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167a9c5f0>]}
[0m17:11:22.902188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:22.906386 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:11:22.907087 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dev.member_G1 ................................. [RUN]
[0m17:11:22.907574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:11:22.907957 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:11:22.916995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:11:22.918284 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:11:22.945626 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m17:11:22.946117 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
      
    
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m17:11:22.946323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:23.719727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2f526f61-784e-4b0d-af75-200c061ad6c5&page=queryresults
[0m17:11:26.172790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6a3a19a-93ae-47ab-8c2c-9499e6e24fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160887260>]}
[0m17:11:26.173476 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dev.member_G1 ............................ [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 3.26s]
[0m17:11:26.173927 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:11:26.174946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:26.175450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:26.175662 [debug] [MainThread]: Connection 'model.dbt_demo.member_G1' was properly closed.
[0m17:11:26.175869 [info ] [MainThread]: 
[0m17:11:26.176079 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m17:11:26.176564 [debug] [MainThread]: Command end result
[0m17:11:26.190741 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:11:26.191778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:11:26.194638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:11:26.194809 [info ] [MainThread]: 
[0m17:11:26.195002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:26.195138 [info ] [MainThread]: 
[0m17:11:26.195292 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:11:26.196657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.769058, "process_in_blocks": "0", "process_kernel_time": 0.933521, "process_mem_max_rss": "425836544", "process_out_blocks": "0", "process_user_time": 3.985846}
[0m17:11:26.196896 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:26.196854 after 5.77 seconds
[0m17:11:26.197071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a23ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166fe20f0>]}
[0m17:11:26.197253 [debug] [MainThread]: Flushing usage events
[0m17:11:27.064480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:43.894535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107280d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107280b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305400>]}


============================== 17:11:43.896287 | cdc37cd6-6d6d-4c88-b699-a41524d5dd9a ==============================
[0m17:11:43.896287 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:11:43.896525 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/angus/.dbt', 'invocation_command': 'dbt test', 'debug': 'False'}
[0m17:11:44.919654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650ab40>]}
[0m17:11:44.946030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b0860>]}
[0m17:11:44.946311 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:11:45.042073 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:11:45.092304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:45.092464 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:45.094187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_demo.example
[0m17:11:45.108120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f3542f0>]}
[0m17:11:45.136131 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:11:45.137074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:11:45.151348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308550ec0>]}
[0m17:11:45.151518 [info ] [MainThread]: Found 1 model, 4 data tests, 1 source, 508 macros
[0m17:11:45.151645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30851ff20>]}
[0m17:11:45.152342 [info ] [MainThread]: 
[0m17:11:45.152473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:11:45.152602 [info ] [MainThread]: 
[0m17:11:45.152821 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:11:45.153172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:11:45.153290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:45.401848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdc37cd6-6d6d-4c88-b699-a41524d5dd9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x30852e270>]}
[0m17:11:45.402278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:45.405102 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:11:45.405467 [info ] [Thread-1 (]: 1 of 4 START test not_null_member_G1_MID ....................................... [RUN]
[0m17:11:45.405810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:11:45.406035 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:11:45.418437 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:11:45.419001 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:11:45.429990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:11:45.430465 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:11:45.430654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:45.919463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8c92cad1-292d-43db-9fdc-bf43edfd9c24&page=queryresults
[0m17:11:46.358670 [info ] [Thread-1 (]: 1 of 4 PASS not_null_member_G1_MID ............................................. [[32mPASS[0m in 0.95s]
[0m17:11:46.359388 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:11:46.359784 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:11:46.360231 [info ] [Thread-1 (]: 2 of 4 START test not_null_member_G1_date ...................................... [RUN]
[0m17:11:46.360684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:11:46.361039 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:11:46.366805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:11:46.367543 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:11:46.369922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:11:46.371043 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:11:46.371702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:46.948888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:a41b500d-ba60-4c78-ad3f-fd9451f63d4e&page=queryresults
[0m17:11:47.396364 [info ] [Thread-1 (]: 2 of 4 PASS not_null_member_G1_date ............................................ [[32mPASS[0m in 1.04s]
[0m17:11:47.397324 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:11:47.397809 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:11:47.398312 [info ] [Thread-1 (]: 3 of 4 START test not_null_member_G1_phones .................................... [RUN]
[0m17:11:47.398896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:11:47.399345 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:11:47.405176 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:11:47.406365 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:11:47.409503 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:11:47.410561 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:11:47.410954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:47.844677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2ec52f2f-f0a6-4f1e-8825-aa3e9abe23c6&page=queryresults
[0m17:11:48.202050 [info ] [Thread-1 (]: 3 of 4 PASS not_null_member_G1_phones .......................................... [[32mPASS[0m in 0.80s]
[0m17:11:48.202890 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:11:48.203453 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:11:48.204194 [info ] [Thread-1 (]: 4 of 4 START test unique_member_G1_MID ......................................... [RUN]
[0m17:11:48.205004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:11:48.205401 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:11:48.211424 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:11:48.212199 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:11:48.214198 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:11:48.214875 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:11:48.215202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:48.693611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7358bf0d-fd3d-4b19-9668-fb3b5894ebce&page=queryresults
[0m17:11:49.059313 [info ] [Thread-1 (]: 4 of 4 PASS unique_member_G1_MID ............................................... [[32mPASS[0m in 0.85s]
[0m17:11:49.060323 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:11:49.062115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:49.062919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:49.063221 [debug] [MainThread]: Connection 'test.dbt_demo.unique_member_G1_MID.90461bb780' was properly closed.
[0m17:11:49.063569 [info ] [MainThread]: 
[0m17:11:49.063921 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m17:11:49.065187 [debug] [MainThread]: Command end result
[0m17:11:49.086288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:11:49.088538 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:11:49.092734 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:11:49.092928 [info ] [MainThread]: 
[0m17:11:49.093138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:49.093288 [info ] [MainThread]: 
[0m17:11:49.093457 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:11:49.094950 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.228071, "process_in_blocks": "0", "process_kernel_time": 1.940871, "process_mem_max_rss": "419282944", "process_out_blocks": "0", "process_user_time": 2.928906}
[0m17:11:49.095212 [debug] [MainThread]: Command `dbt test` succeeded at 17:11:49.095158 after 5.23 seconds
[0m17:11:49.095424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c29ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ad310>]}
[0m17:11:49.095619 [debug] [MainThread]: Flushing usage events
[0m17:11:49.944165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:46.608851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bf950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75e330>]}


============================== 17:13:46.611340 | 599a2811-868c-4267-bbba-f0fd46fe6db5 ==============================
[0m17:13:46.611340 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:13:46.611564 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/angus/.dbt', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'warn_error': 'None', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m17:13:47.903398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148689010>]}
[0m17:13:47.928400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14826d5e0>]}
[0m17:13:47.928621 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:13:48.026432 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:13:48.059923 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:13:48.060149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489bacf0>]}
[0m17:13:48.523019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_demo.marts
- models.dbt_demo.view
[0m17:13:48.526441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2f60f0>]}
[0m17:13:48.553493 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:13:48.554471 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:13:48.564102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a09af00>]}
[0m17:13:48.564271 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 508 macros
[0m17:13:48.564389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2c7740>]}
[0m17:13:48.565042 [info ] [MainThread]: 
[0m17:13:48.565179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:48.565272 [info ] [MainThread]: 
[0m17:13:48.565454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:13:48.566745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m17:13:48.566906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:49.049097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m17:13:49.049796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:49.256536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a4aef30>]}
[0m17:13:49.257434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:49.262268 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:13:49.262972 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev.member_G1 ................................. [RUN]
[0m17:13:49.263408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:13:49.263739 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:13:49.271861 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:13:49.272975 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:13:49.283793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:49.473666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m17:13:49.475428 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
      
    
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m17:13:49.822749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:3dc739d6-3e40-4f11-bff7-96e47c2a75eb&page=queryresults
[0m17:13:52.666274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a575070>]}
[0m17:13:52.666798 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev.member_G1 ............................ [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 3.40s]
[0m17:13:52.667197 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:13:52.667449 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:13:52.667782 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_dev.member_P221 ................................ [RUN]
[0m17:13:52.668092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:13:52.668311 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:13:52.670405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:13:52.670857 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:13:52.680774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m17:13:52.681177 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m17:13:52.681367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:52.983152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:64997b69-2686-4ada-b27a-c8d67da55f54&page=queryresults
[0m17:13:53.201649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599a2811-868c-4267-bbba-f0fd46fe6db5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a42faa0>]}
[0m17:13:53.202521 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_dev.member_P221 ........................... [[32mCREATE VIEW (0 processed)[0m in 0.53s]
[0m17:13:53.203263 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:13:53.204685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:53.205288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:53.205516 [debug] [MainThread]: Connection 'model.dbt_demo.member_P221' was properly closed.
[0m17:13:53.205762 [info ] [MainThread]: 
[0m17:13:53.206008 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m17:13:53.206650 [debug] [MainThread]: Command end result
[0m17:13:53.223885 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:13:53.225031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:13:53.232998 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:13:53.233298 [info ] [MainThread]: 
[0m17:13:53.234795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:53.235070 [info ] [MainThread]: 
[0m17:13:53.235307 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:13:53.241112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.664901, "process_in_blocks": "0", "process_kernel_time": 0.503393, "process_mem_max_rss": "427442176", "process_out_blocks": "0", "process_user_time": 4.807427}
[0m17:13:53.241413 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:53.241364 after 6.67 seconds
[0m17:13:53.241599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a433290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1489b9250>]}
[0m17:13:53.241764 [debug] [MainThread]: Flushing usage events
[0m17:13:54.268203 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:00.485235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a42ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a42c60>]}


============================== 17:14:00.486987 | 5784d5cf-4a86-462f-b0dd-e28432d9e42b ==============================
[0m17:14:00.486987 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:14:00.487223 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'profiles_dir': '/Users/angus/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False'}
[0m17:14:01.483898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054102c0>]}
[0m17:14:01.509378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10347d370>]}
[0m17:14:01.509643 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:14:01.609431 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:14:01.658864 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:01.659010 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:01.660730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_demo.view
- models.dbt_demo.marts
[0m17:14:01.674575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1442f51f0>]}
[0m17:14:01.702082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:14:01.702893 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:14:01.716526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448f24b0>]}
[0m17:14:01.716707 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 508 macros
[0m17:14:01.716834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1448240b0>]}
[0m17:14:01.717560 [info ] [MainThread]: 
[0m17:14:01.717700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:01.717795 [info ] [MainThread]: 
[0m17:14:01.717975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:14:01.719313 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:14:01.719440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:01.967526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5784d5cf-4a86-462f-b0dd-e28432d9e42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10347d6a0>]}
[0m17:14:01.968072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:14:01.970884 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:14:01.971221 [info ] [Thread-1 (]: 1 of 8 START test not_null_member_G1_MID ....................................... [RUN]
[0m17:14:01.971523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:14:01.971869 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:14:01.983966 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:14:01.984530 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:14:01.995675 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:14:01.996118 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:14:01.996315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:02.457208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:4064c8e0-7baf-4634-bade-e077002b537f&page=queryresults
[0m17:14:02.815047 [info ] [Thread-1 (]: 1 of 8 PASS not_null_member_G1_MID ............................................. [[32mPASS[0m in 0.84s]
[0m17:14:02.815909 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:14:02.816378 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:14:02.816874 [info ] [Thread-1 (]: 2 of 8 START test not_null_member_G1_date ...................................... [RUN]
[0m17:14:02.817447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:14:02.817897 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:14:02.822774 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:14:02.823631 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:14:02.828092 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:14:02.828774 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:14:02.829102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:03.344340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:de8e6379-e00a-49a1-95d9-4eec07ee4d36&page=queryresults
[0m17:14:03.649622 [info ] [Thread-1 (]: 2 of 8 PASS not_null_member_G1_date ............................................ [[32mPASS[0m in 0.83s]
[0m17:14:03.650432 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:14:03.650836 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:14:03.651234 [info ] [Thread-1 (]: 3 of 8 START test not_null_member_G1_phones .................................... [RUN]
[0m17:14:03.651639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:14:03.651919 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:14:03.657366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:14:03.658062 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:14:03.660041 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:14:03.660542 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:14:03.660833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:04.068125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:a166e766-cea4-45d8-9a3a-059b337da421&page=queryresults
[0m17:14:04.324148 [info ] [Thread-1 (]: 3 of 8 PASS not_null_member_G1_phones .......................................... [[32mPASS[0m in 0.67s]
[0m17:14:04.325044 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:14:04.325495 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:14:04.325988 [info ] [Thread-1 (]: 4 of 8 START test not_null_member_P221_MID ..................................... [RUN]
[0m17:14:04.326561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m17:14:04.326986 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:14:04.332727 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:14:04.334244 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:14:04.337563 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:14:04.338511 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_MID.528f4abc43: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_MID.528f4abc43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:14:04.338951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:05.870584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8b9cc7d9-d2cf-41c8-9542-a5744270a89b&page=queryresults
[0m17:14:06.154111 [info ] [Thread-1 (]: 4 of 8 PASS not_null_member_P221_MID ........................................... [[32mPASS[0m in 1.83s]
[0m17:14:06.155008 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:14:06.155451 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:14:06.156092 [info ] [Thread-1 (]: 5 of 8 START test not_null_member_P221_date .................................... [RUN]
[0m17:14:06.156640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m17:14:06.157029 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:14:06.162260 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:14:06.163639 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:14:06.166725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:14:06.167608 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_date.0430b9cd72: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_date.0430b9cd72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:14:06.168033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:07.023079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:9a8fee56-bbab-459c-a066-e2499bf35057&page=queryresults
[0m17:14:07.317698 [info ] [Thread-1 (]: 5 of 8 PASS not_null_member_P221_date .......................................... [[32mPASS[0m in 1.16s]
[0m17:14:07.318595 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:14:07.319035 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:14:07.319497 [info ] [Thread-1 (]: 6 of 8 START test not_null_member_P221_phones .................................. [RUN]
[0m17:14:07.320039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m17:14:07.320427 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:14:07.325751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:14:07.327077 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:14:07.329802 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:14:07.330673 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:14:07.331118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:08.875707 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:05f1e559-a42b-42cc-af75-9eac0d1fa518&page=queryresults
[0m17:14:09.118919 [info ] [Thread-1 (]: 6 of 8 PASS not_null_member_P221_phones ........................................ [[32mPASS[0m in 1.80s]
[0m17:14:09.119794 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:14:09.120226 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:14:09.120648 [info ] [Thread-1 (]: 7 of 8 START test unique_member_G1_MID ......................................... [RUN]
[0m17:14:09.121192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:14:09.121578 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:14:09.131625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:14:09.132612 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:14:09.135516 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:14:09.136400 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:14:09.136895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:09.592517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8a78cfc6-cc41-430f-b2b9-4b138f8ed0ad&page=queryresults
[0m17:14:09.829043 [info ] [Thread-1 (]: 7 of 8 PASS unique_member_G1_MID ............................................... [[32mPASS[0m in 0.71s]
[0m17:14:09.829905 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:14:09.830349 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:14:09.830792 [info ] [Thread-1 (]: 8 of 8 START test unique_member_P221_MID ....................................... [RUN]
[0m17:14:09.831346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m17:14:09.831728 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:14:09.836990 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:14:09.837967 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:14:09.840894 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:14:09.841725 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_P221_MID.a77105e8ee: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_P221_MID.a77105e8ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:14:09.842066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:14:11.300464 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:1e0c28b3-19ce-4558-83a9-d22ec7f8626c&page=queryresults
[0m17:14:11.607036 [info ] [Thread-1 (]: 8 of 8 PASS unique_member_P221_MID ............................................. [[32mPASS[0m in 1.78s]
[0m17:14:11.607881 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:14:11.609396 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:14:11.610116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:11.610423 [debug] [MainThread]: Connection 'test.dbt_demo.unique_member_P221_MID.a77105e8ee' was properly closed.
[0m17:14:11.610755 [info ] [MainThread]: 
[0m17:14:11.611103 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 9.89 seconds (9.89s).
[0m17:14:11.612782 [debug] [MainThread]: Command end result
[0m17:14:11.634333 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:14:11.635817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:14:11.640397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:14:11.640598 [info ] [MainThread]: 
[0m17:14:11.640830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:11.640999 [info ] [MainThread]: 
[0m17:14:11.641182 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m17:14:11.642887 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 11.1862, "process_in_blocks": "0", "process_kernel_time": 1.464829, "process_mem_max_rss": "419594240", "process_out_blocks": "0", "process_user_time": 3.69938}
[0m17:14:11.643164 [debug] [MainThread]: Command `dbt test` succeeded at 17:14:11.643106 after 11.19 seconds
[0m17:14:11.643378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105874860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c60c0>]}
[0m17:14:11.643572 [debug] [MainThread]: Flushing usage events
[0m17:14:12.493893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:19.761512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070be480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e42ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e42840>]}


============================== 17:22:19.763898 | a02d3373-6ae0-406a-abae-56dbeb9432bc ==============================
[0m17:22:19.763898 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:22:19.764148 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/angus/.dbt', 'debug': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m17:22:21.060526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a02d3373-6ae0-406a-abae-56dbeb9432bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f7b6720>]}
[0m17:22:21.085936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a02d3373-6ae0-406a-abae-56dbeb9432bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb9a540>]}
[0m17:22:21.086185 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:22:21.185031 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:22:21.235951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:21.236215 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:22:21.310451 [error] [MainThread]: Encountered an error:
Compilation Error in model member_G1 (models/staging/member_G1.sql)
  expected token ',', got '='
    line 2
      -- materialized='table', -- can omit (same as dbt_project.yml)
[0m17:22:21.311507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5834467, "process_in_blocks": "0", "process_kernel_time": 0.487474, "process_mem_max_rss": "405504000", "process_out_blocks": "0", "process_user_time": 4.052905}
[0m17:22:21.311738 [debug] [MainThread]: Command `dbt run` failed at 17:22:21.311701 after 1.58 seconds
[0m17:22:21.311890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e42330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1613ef7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1613c8320>]}
[0m17:22:21.312007 [debug] [MainThread]: Flushing usage events
[0m17:22:22.287525 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:01.438632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a2810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a2900>]}


============================== 17:23:01.441004 | e7f0e0d4-7809-45ff-889b-7372a6f9979e ==============================
[0m17:23:01.441004 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:23:01.441244 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/angus/.dbt', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80'}
[0m17:23:02.762255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f0e0d4-7809-45ff-889b-7372a6f9979e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1445b1d00>]}
[0m17:23:02.787867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f0e0d4-7809-45ff-889b-7372a6f9979e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1444d5520>]}
[0m17:23:02.788110 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:23:02.886549 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:23:02.937429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:02.937695 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:23:03.014686 [error] [MainThread]: Encountered an error:
Compilation Error in model member_G1 (models/staging/member_G1.sql)
  expected token ',', got '='
    line 2
      -- materialized='table', -- can omit (same as dbt_project.yml)
[0m17:23:03.015735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.606397, "process_in_blocks": "0", "process_kernel_time": 0.72949, "process_mem_max_rss": "405946368", "process_out_blocks": "0", "process_user_time": 3.809152}
[0m17:23:03.015975 [debug] [MainThread]: Command `dbt run` failed at 17:23:03.015938 after 1.61 seconds
[0m17:23:03.016118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ded610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144def230>]}
[0m17:23:03.016242 [debug] [MainThread]: Flushing usage events
[0m17:23:03.877994 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:12.021624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087be420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b22570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b22210>]}


============================== 17:23:12.023340 | 7e44f96f-229e-4969-844f-43731b3ede06 ==============================
[0m17:23:12.023340 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:23:12.023576 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'profiles_dir': '/Users/angus/.dbt', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:23:13.104246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e44f96f-229e-4969-844f-43731b3ede06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cb8590>]}
[0m17:23:13.130284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e44f96f-229e-4969-844f-43731b3ede06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fa9f0>]}
[0m17:23:13.130509 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:23:13.229369 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:23:13.280383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:13.280627 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:23:13.357952 [error] [MainThread]: Encountered an error:
Compilation Error in model member_G1 (models/staging/member_G1.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m17:23:13.359031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3661568, "process_in_blocks": "0", "process_kernel_time": 1.263921, "process_mem_max_rss": "407339008", "process_out_blocks": "0", "process_user_time": 3.308316}
[0m17:23:13.359257 [debug] [MainThread]: Command `dbt run` failed at 17:23:13.359222 after 1.37 seconds
[0m17:23:13.359408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14795eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cbb320>]}
[0m17:23:13.359535 [debug] [MainThread]: Flushing usage events
[0m17:23:14.219244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:29.167860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e56900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f6510>]}


============================== 17:23:29.169670 | 23ced739-f254-4a5e-b645-880a9484d17c ==============================
[0m17:23:29.169670 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:23:29.169907 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '/Users/angus/.dbt', 'use_colors': 'True', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'quiet': 'False', 'target_path': 'None'}
[0m17:23:30.291622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a2540>]}
[0m17:23:30.317636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x179dcadb0>]}
[0m17:23:30.317879 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:23:30.419014 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:23:30.469137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:30.469392 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:23:30.626928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_demo.view
- models.dbt_demo.marts
[0m17:23:30.631342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17ae09160>]}
[0m17:23:30.659673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:23:30.660885 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:23:30.670571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17aecbfb0>]}
[0m17:23:30.670756 [info ] [MainThread]: Found 2 models, 8 data tests, 1 source, 508 macros
[0m17:23:30.670882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d26e210>]}
[0m17:23:30.671546 [info ] [MainThread]: 
[0m17:23:30.671673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:23:30.671767 [info ] [MainThread]: 
[0m17:23:30.671947 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:23:30.673221 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m17:23:30.673360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:32.225120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m17:23:32.225320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:32.600365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17aecac90>]}
[0m17:23:32.601146 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:32.605353 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:23:32.605993 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_dev.member_G1 ................................. [RUN]
[0m17:23:32.606447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:23:32.606802 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:23:32.615302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:23:32.616383 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:23:32.633950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:32.800438 [debug] [Thread-1 (]: Hard refreshing `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1` because it is not replaceable
[0m17:23:32.957290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m17:23:32.957802 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
       
select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m17:23:33.363408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:bf4ccda1-58ba-40e3-96de-0713de93dde3&page=queryresults
[0m17:23:42.084818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ae8e720>]}
[0m17:23:42.086372 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_dev.member_G1 ............................ [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 9.48s]
[0m17:23:42.086823 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:23:42.087162 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:23:42.087498 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt_dev.member_P221 ................................ [RUN]
[0m17:23:42.087761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:23:42.087969 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:23:42.090376 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:23:42.090862 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:23:42.102617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m17:23:42.103130 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m17:23:42.103342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:23:42.387686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e9e5ac47-c62d-4ad7-890d-f767949b356f&page=queryresults
[0m17:23:42.712887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23ced739-f254-4a5e-b645-880a9484d17c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17f47fa10>]}
[0m17:23:42.713173 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt_dev.member_P221 ........................... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m17:23:42.713401 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:23:42.714100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:42.714382 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:42.714497 [debug] [MainThread]: Connection 'model.dbt_demo.member_P221' was properly closed.
[0m17:23:42.714612 [info ] [MainThread]: 
[0m17:23:42.714736 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.04 seconds (12.04s).
[0m17:23:42.715057 [debug] [MainThread]: Command end result
[0m17:23:42.739343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:23:42.742049 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:23:42.747071 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:23:42.747479 [info ] [MainThread]: 
[0m17:23:42.747683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:23:42.747793 [info ] [MainThread]: 
[0m17:23:42.747909 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m17:23:42.754076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.61463, "process_in_blocks": "0", "process_kernel_time": 1.706694, "process_mem_max_rss": "420200448", "process_out_blocks": "0", "process_user_time": 3.267739}
[0m17:23:42.754731 [debug] [MainThread]: Command `dbt run` succeeded at 17:23:42.754626 after 13.62 seconds
[0m17:23:42.755118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17a81a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e8fe30>]}
[0m17:23:42.755396 [debug] [MainThread]: Flushing usage events
[0m17:23:43.598707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:08.596496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d5b2c0>]}


============================== 17:38:08.598897 | 10f02494-16f8-4aa2-8edc-db8e8e1430aa ==============================
[0m17:38:08.598897 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:38:08.599126 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/Users/angus/.dbt', 'partial_parse': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True'}
[0m17:38:09.896949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fb68da0>]}
[0m17:38:09.922463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ee7b170>]}
[0m17:38:09.922698 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:38:10.022650 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:38:10.073230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m17:38:10.073450 [debug] [MainThread]: Partial parsing: added file: dbt_demo://models/view/stats_G1_24M11.sql
[0m17:38:10.073562 [debug] [MainThread]: Partial parsing: added file: dbt_demo://models/marts/stats_G1.sql
[0m17:38:10.073698 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/view/schema.yml
[0m17:38:10.073809 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/marts/schema.yml
[0m17:38:10.073935 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:38:10.241559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109061040>]}
[0m17:38:10.270472 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:38:10.271547 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:38:10.282795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168bf7d10>]}
[0m17:38:10.282973 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:38:10.283097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1686032f0>]}
[0m17:38:10.283817 [info ] [MainThread]: 
[0m17:38:10.283947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:10.284038 [info ] [MainThread]: 
[0m17:38:10.284213 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:10.285549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m17:38:10.285692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:10.805932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m17:38:10.806668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:11.031418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16872d0a0>]}
[0m17:38:11.032289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:11.036478 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:38:11.037153 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dev.member_G1 ................................. [RUN]
[0m17:38:11.037598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:38:11.037909 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:38:11.047805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:38:11.048590 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:38:11.065093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:11.253158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m17:38:11.253931 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

 

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m17:38:11.703415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:bd002712-1413-4181-9026-8b07ffd608be&page=queryresults
[0m17:38:22.274304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd9910>]}
[0m17:38:22.274903 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dev.member_G1 ............................ [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 11.23s]
[0m17:38:22.275331 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:38:22.275605 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:38:22.276025 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_dev.member_P221 ................................ [RUN]
[0m17:38:22.276469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:38:22.276755 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:38:22.279092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:38:22.279881 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:38:22.292677 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m17:38:22.293154 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m17:38:22.293358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:22.666317 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:51212312-c331-46e7-9760-94522fb9405b&page=queryresults
[0m17:38:22.828069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16811c950>]}
[0m17:38:22.828941 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_dev.member_P221 ........................... [[32mCREATE VIEW (0 processed)[0m in 0.55s]
[0m17:38:22.829423 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:38:22.829743 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m17:38:22.830178 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dev.stats_G1 .................................. [RUN]
[0m17:38:22.830581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m17:38:22.830846 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m17:38:22.833265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m17:38:22.834008 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m17:38:22.835954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1"
[0m17:38:22.836716 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.stats_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
      
    
    

    
    OPTIONS()
    as (
      select date_trunc(date, month) month_date, substring(phones,9,1) second_last_digit, count(distinct MID) counts
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1` 
group by month_date, second_last_digit
    );
  
[0m17:38:22.837018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:23.298071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:5a434c96-2e5f-483f-b5d1-50a3aca56b31&page=queryresults
[0m17:38:25.591289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169163290>]}
[0m17:38:25.591626 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dev.stats_G1 ............................. [[32mCREATE TABLE (312.0 rows, 31.2 KiB processed)[0m in 2.76s]
[0m17:38:25.591836 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m17:38:25.592117 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m17:38:25.592296 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_dev.stats_G1_24M11 ............................. [RUN]
[0m17:38:25.592502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now model.dbt_demo.stats_G1_24M11)
[0m17:38:25.592752 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m17:38:25.593916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m17:38:25.594253 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m17:38:25.595212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1_24M11"
[0m17:38:25.595495 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1_24M11: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.stats_G1_24M11"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
  OPTIONS()
  as select second_last_digit, counts
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1` 
where month_date = "2024-11-1";


[0m17:38:25.595634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:26.046299 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2c4e2ed9-a7b5-4fff-9170-c268a97a46e6&page=queryresults
[0m17:38:26.195271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10f02494-16f8-4aa2-8edc-db8e8e1430aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16917d5e0>]}
[0m17:38:26.195867 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_dev.stats_G1_24M11 ........................ [[32mCREATE VIEW (0 processed)[0m in 0.60s]
[0m17:38:26.196276 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m17:38:26.197081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:26.197526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:26.197736 [debug] [MainThread]: Connection 'model.dbt_demo.stats_G1_24M11' was properly closed.
[0m17:38:26.197982 [info ] [MainThread]: 
[0m17:38:26.198211 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.91 seconds (15.91s).
[0m17:38:26.198892 [debug] [MainThread]: Command end result
[0m17:38:26.213816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:38:26.214801 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:38:26.217934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:38:26.218193 [info ] [MainThread]: 
[0m17:38:26.218428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:26.218576 [info ] [MainThread]: 
[0m17:38:26.218733 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:38:26.220205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.658215, "process_in_blocks": "0", "process_kernel_time": 0.389916, "process_mem_max_rss": "427098112", "process_out_blocks": "0", "process_user_time": 4.730092}
[0m17:38:26.220748 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:26.220698 after 17.66 seconds
[0m17:38:26.220947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16872d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1687f8b60>]}
[0m17:38:26.221121 [debug] [MainThread]: Flushing usage events
[0m17:38:27.211306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:37.591611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fef740>]}


============================== 17:38:37.593996 | d169ce9a-0dbb-4041-ba1c-ceb207147c45 ==============================
[0m17:38:37.593996 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:38:37.594244 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/Users/angus/.dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True'}
[0m17:38:38.731016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc0950>]}
[0m17:38:38.758505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146120>]}
[0m17:38:38.758823 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:38:38.859467 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:38:38.911722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:38.911882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:38.926830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16643ec90>]}
[0m17:38:38.954826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:38:38.955728 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:38:38.969476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16735d880>]}
[0m17:38:38.969665 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:38:38.969790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16725dee0>]}
[0m17:38:38.970592 [info ] [MainThread]: 
[0m17:38:38.970723 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:38.970815 [info ] [MainThread]: 
[0m17:38:38.970992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:38.972358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:38:38.972487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:39.245787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd169ce9a-0dbb-4041-ba1c-ceb207147c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb620>]}
[0m17:38:39.246312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:39.249420 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:38:39.249754 [info ] [Thread-1 (]: 1 of 12 START test not_null_member_G1_MID ...................................... [RUN]
[0m17:38:39.250101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:38:39.250371 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:38:39.264668 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:38:39.265512 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:38:39.277005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:38:39.277615 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:38:39.277815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:40.219767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:4d7d0517-4270-44a2-8114-9130e20143dd&page=queryresults
[0m17:38:40.545669 [info ] [Thread-1 (]: 1 of 12 PASS not_null_member_G1_MID ............................................ [[32mPASS[0m in 1.30s]
[0m17:38:40.545960 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:38:40.546111 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:38:40.546294 [info ] [Thread-1 (]: 2 of 12 START test not_null_member_G1_date ..................................... [RUN]
[0m17:38:40.546495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:38:40.546619 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:38:40.548308 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:38:40.548586 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:38:40.549398 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:38:40.549624 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:38:40.549753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:41.079560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:99115961-1d01-4ed0-acda-8380d83c5194&page=queryresults
[0m17:38:41.373315 [info ] [Thread-1 (]: 2 of 12 PASS not_null_member_G1_date ........................................... [[32mPASS[0m in 0.83s]
[0m17:38:41.374238 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:38:41.374690 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:38:41.375163 [info ] [Thread-1 (]: 3 of 12 START test not_null_member_G1_phones ................................... [RUN]
[0m17:38:41.375687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:38:41.376065 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:38:41.382268 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:38:41.383583 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:38:41.386839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:38:41.387721 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:38:41.388085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:42.350768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:b3805e1b-0d83-4e42-83ce-2a1942c8ba52&page=queryresults
[0m17:38:42.650418 [info ] [Thread-1 (]: 3 of 12 PASS not_null_member_G1_phones ......................................... [[32mPASS[0m in 1.27s]
[0m17:38:42.651489 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:38:42.652004 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:38:42.652462 [info ] [Thread-1 (]: 4 of 12 START test not_null_member_P221_MID .................................... [RUN]
[0m17:38:42.653039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m17:38:42.653433 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:38:42.658223 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:38:42.659219 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:38:42.661831 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:38:42.662540 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_MID.528f4abc43: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_MID.528f4abc43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:38:42.662866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:43.872391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:28b639bf-d060-45dc-8e0d-5ab9edee1182&page=queryresults
[0m17:38:44.138943 [info ] [Thread-1 (]: 4 of 12 PASS not_null_member_P221_MID .......................................... [[32mPASS[0m in 1.49s]
[0m17:38:44.139776 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:38:44.140209 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:38:44.140661 [info ] [Thread-1 (]: 5 of 12 START test not_null_member_P221_date ................................... [RUN]
[0m17:38:44.141183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m17:38:44.141551 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:38:44.146387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:38:44.148317 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:38:44.151474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:38:44.152537 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_date.0430b9cd72: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_date.0430b9cd72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:38:44.152955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:45.092953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:a9abfb1d-fd2a-4ab8-b6b7-c21047e2cc10&page=queryresults
[0m17:38:45.411391 [info ] [Thread-1 (]: 5 of 12 PASS not_null_member_P221_date ......................................... [[32mPASS[0m in 1.27s]
[0m17:38:45.412473 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:38:45.412931 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:38:45.413399 [info ] [Thread-1 (]: 6 of 12 START test not_null_member_P221_phones ................................. [RUN]
[0m17:38:45.413981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m17:38:45.414382 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:38:45.422041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:38:45.422978 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:38:45.425709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:38:45.426595 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:38:45.427001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:46.833057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7f33ef4c-5c6b-402e-8d72-37c269431b87&page=queryresults
[0m17:38:47.097392 [info ] [Thread-1 (]: 6 of 12 PASS not_null_member_P221_phones ....................................... [[32mPASS[0m in 1.68s]
[0m17:38:47.098282 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:38:47.098716 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:38:47.099151 [info ] [Thread-1 (]: 7 of 12 START test not_null_stats_G1_24M11_second_last_digit ................... [RUN]
[0m17:38:47.099653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m17:38:47.100049 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:38:47.106983 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:38:47.108312 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:38:47.111109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:38:47.112346 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m17:38:47.112892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:47.857938 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e0727f98-6bc8-4292-8a15-45f91146f2c3&page=queryresults
[0m17:38:48.086090 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stats_G1_24M11_second_last_digit ......................... [[32mPASS[0m in 0.99s]
[0m17:38:48.087097 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:38:48.087531 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:38:48.087967 [info ] [Thread-1 (]: 8 of 12 START test not_null_stats_G1_month_date ................................ [RUN]
[0m17:38:48.088479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m17:38:48.088849 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:38:48.094563 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:38:48.095726 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:38:48.098951 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:38:48.100125 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_date
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
where month_date is null



  
  
      
    ) dbt_internal_test
[0m17:38:48.100812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:48.573502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:20434e5c-18a1-4da1-9f19-1f479c52e55e&page=queryresults
[0m17:38:48.799244 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stats_G1_month_date ...................................... [[32mPASS[0m in 0.71s]
[0m17:38:48.800682 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:38:48.801216 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:38:48.801783 [info ] [Thread-1 (]: 9 of 12 START test not_null_stats_G1_second_last_digit ......................... [RUN]
[0m17:38:48.802330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m17:38:48.802709 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:38:48.808749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:38:48.810017 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:38:48.812983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:38:48.813996 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m17:38:48.814429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:49.183472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:25108828-66a8-421a-8502-4e80a0c169a1&page=queryresults
[0m17:38:49.445257 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stats_G1_second_last_digit ............................... [[32mPASS[0m in 0.64s]
[0m17:38:49.446340 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:38:49.446864 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:38:49.447443 [info ] [Thread-1 (]: 10 of 12 START test unique_member_G1_MID ....................................... [RUN]
[0m17:38:49.448075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:38:49.448469 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:38:49.457892 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:38:49.458786 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:38:49.461927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:38:49.462500 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:38:49.462813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:50.622384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:35850637-cc5d-4982-a77b-8ae0ac99a3b7&page=queryresults
[0m17:38:50.830543 [info ] [Thread-1 (]: 10 of 12 PASS unique_member_G1_MID ............................................. [[32mPASS[0m in 1.38s]
[0m17:38:50.831365 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:38:50.831844 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:38:50.832301 [info ] [Thread-1 (]: 11 of 12 START test unique_member_P221_MID ..................................... [RUN]
[0m17:38:50.832752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m17:38:50.833106 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:38:50.838737 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:38:50.839918 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:38:50.843032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:38:50.844145 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_P221_MID.a77105e8ee: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_P221_MID.a77105e8ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:38:50.844688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:52.136197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:c91f86fa-40e3-4684-bbcc-05d61cf7dadc&page=queryresults
[0m17:38:52.382393 [info ] [Thread-1 (]: 11 of 12 PASS unique_member_P221_MID ........................................... [[32mPASS[0m in 1.55s]
[0m17:38:52.383333 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:38:52.383831 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:38:52.384263 [info ] [Thread-1 (]: 12 of 12 START test unique_stats_G1_24M11_second_last_digit .................... [RUN]
[0m17:38:52.384902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m17:38:52.385404 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:38:52.390692 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:38:52.391729 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:38:52.395122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:38:52.396281 [debug] [Thread-1 (]: On test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select second_last_digit as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
  where second_last_digit is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:38:52.396723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:53.022293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:4d52db68-467d-4b34-8b30-60c939323724&page=queryresults
[0m17:38:53.320284 [info ] [Thread-1 (]: 12 of 12 PASS unique_stats_G1_24M11_second_last_digit .......................... [[32mPASS[0m in 0.94s]
[0m17:38:53.320901 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:38:53.322155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:53.322728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:53.323000 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m17:38:53.323288 [info ] [MainThread]: 
[0m17:38:53.323567 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m17:38:53.325261 [debug] [MainThread]: Command end result
[0m17:38:53.336189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:38:53.337477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:38:53.340791 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:38:53.340937 [info ] [MainThread]: 
[0m17:38:53.341074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:53.341174 [info ] [MainThread]: 
[0m17:38:53.341290 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m17:38:53.342464 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 15.780224, "process_in_blocks": "0", "process_kernel_time": 0.385896, "process_mem_max_rss": "417792000", "process_out_blocks": "0", "process_user_time": 4.946715}
[0m17:38:53.342689 [debug] [MainThread]: Command `dbt test` succeeded at 17:38:53.342645 after 15.78 seconds
[0m17:38:53.342884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c0aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f98bc0>]}
[0m17:38:53.343041 [debug] [MainThread]: Flushing usage events
[0m17:38:54.196629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:30.532976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b642c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138eef90>]}


============================== 17:39:30.535528 | a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec ==============================
[0m17:39:30.535528 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:39:30.535754 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'target_path': 'None', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate', 'no_print': 'None', 'empty': 'None', 'profiles_dir': '/Users/angus/.dbt', 'log_cache_events': 'False', 'write_json': 'True', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m17:39:31.814110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c3c3d70>]}
[0m17:39:31.840987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c3c2db0>]}
[0m17:39:31.841293 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:39:31.942150 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:39:31.996019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:39:31.996195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:39:32.011161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b4b2000>]}
[0m17:39:32.020743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b7561e0>]}
[0m17:39:32.020928 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:39:32.021060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b6ac560>]}
[0m17:39:32.021809 [info ] [MainThread]: 
[0m17:39:32.021942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:32.022038 [info ] [MainThread]: 
[0m17:39:32.022205 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:39:32.023516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:39:32.023651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:32.303008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a88a96fc-5811-4ff3-a4ad-9c5f0cb880ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c2ae7b0>]}
[0m17:39:32.303452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:32.305793 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:39:32.306199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:39:32.306495 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:39:32.315013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:39:32.315530 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:39:32.315768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.316249 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:39:32.316485 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:39:32.316783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:39:32.317086 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:39:32.318906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:39:32.319229 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:39:32.319399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.319771 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:39:32.319956 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m17:39:32.320155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m17:39:32.320342 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m17:39:32.321939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m17:39:32.322306 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m17:39:32.322488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.322938 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m17:39:32.323147 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:39:32.323359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:39:32.323548 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:39:32.329392 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:39:32.329707 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:39:32.329866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.330215 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:39:32.330382 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:39:32.330552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:39:32.330705 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:39:32.332556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:39:32.332808 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:39:32.332955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.333317 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:39:32.333469 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:39:32.333625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:39:32.333825 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:39:32.335857 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:39:32.336179 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:39:32.336339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.336660 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:39:32.336816 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:39:32.336979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:39:32.337117 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:39:32.339748 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:39:32.340005 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:39:32.340139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.340424 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:39:32.340564 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:39:32.340706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m17:39:32.340834 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:39:32.342390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:39:32.342622 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:39:32.342750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.343017 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:39:32.343157 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:39:32.343359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m17:39:32.343491 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:39:32.344956 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:39:32.345163 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:39:32.345282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.345535 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:39:32.345666 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:39:32.345796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m17:39:32.345918 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:39:32.348040 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:39:32.348252 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:39:32.348374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.348618 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:39:32.348749 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:39:32.348876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m17:39:32.348993 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:39:32.350486 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:39:32.350687 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:39:32.350808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.351044 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:39:32.351177 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m17:39:32.351302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now model.dbt_demo.stats_G1_24M11)
[0m17:39:32.351416 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m17:39:32.352340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m17:39:32.352542 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m17:39:32.352656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.352889 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m17:39:32.353009 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:39:32.353140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1_24M11, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m17:39:32.353333 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:39:32.354687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:39:32.354882 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:39:32.354997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.355239 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:39:32.355364 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:39:32.355488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m17:39:32.355602 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:39:32.356896 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:39:32.357083 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:39:32.357203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.357427 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:39:32.357546 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:39:32.357664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m17:39:32.357775 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:39:32.359049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:39:32.359238 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:39:32.359350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.359573 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:39:32.359694 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:39:32.359815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m17:39:32.359925 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:39:32.361200 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:39:32.361387 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:39:32.361495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:39:32.361710 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:39:32.362092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:32.362205 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m17:39:32.362953 [debug] [MainThread]: Command end result
[0m17:39:32.393718 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:39:32.394757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:39:32.397019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:39:32.398769 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m17:39:32.398891 [info ] [MainThread]: Building catalog
[0m17:39:32.400614 [debug] [ThreadPool]: Acquiring new bigquery connection 'tw-rd-data-angus-tu.information_schema'
[0m17:39:32.407388 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dbt_dev`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('stats_G1_24M11')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('member_P221')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('stats_G1')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('member_G1')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:39:32.407752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:32.812173 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7ccae530-6aee-485d-8bdf-461db9705b8c&page=queryresults
[0m17:39:34.094092 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dataform`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataform')
                            and upper(table_name) = upper('member')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:39:34.094525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:34.450678 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:bed391e8-450d-420c-a182-9028bf62a087&page=queryresults
[0m17:39:35.648548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:35.658369 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m17:39:35.675423 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:39:35.676522 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:39:35.676709 [info ] [MainThread]: Catalog written to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m17:39:35.678255 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 5.1753955, "process_in_blocks": "0", "process_kernel_time": 0.342754, "process_mem_max_rss": "417497088", "process_out_blocks": "0", "process_user_time": 4.505686}
[0m17:39:35.678605 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:39:35.678549 after 5.18 seconds
[0m17:39:35.678790 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:39:35.678937 [debug] [MainThread]: Connection 'tw-rd-data-angus-tu.information_schema' was properly closed.
[0m17:39:35.679109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138ef320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b26ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a24800>]}
[0m17:39:35.679298 [debug] [MainThread]: Flushing usage events
[0m17:39:36.502140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:39.320037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfe1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfde80>]}


============================== 17:39:39.321770 | 57980b3f-c731-4db0-aee9-6a5d94f39227 ==============================
[0m17:39:39.321770 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:39:39.322007 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'no_print': 'None', 'use_colors': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8088', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/angus/.dbt', 'empty': 'None', 'version_check': 'True'}
[0m17:39:40.320832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57980b3f-c731-4db0-aee9-6a5d94f39227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168c4b920>]}
[0m17:39:40.347081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57980b3f-c731-4db0-aee9-6a5d94f39227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16875e4b0>]}
[0m17:44:01.342402 [error] [MainThread]: Encountered an error:

[0m17:44:01.351909 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:44:01.356240 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 262.21814, "process_in_blocks": "0", "process_kernel_time": 1.261216, "process_mem_max_rss": "397852672", "process_out_blocks": "0", "process_user_time": 3.030383}
[0m17:44:01.359236 [debug] [MainThread]: Command `dbt docs serve` failed at 17:44:01.359053 after 262.22 seconds
[0m17:44:01.360175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbfe030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa79970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168e2cce0>]}
[0m17:44:01.360922 [debug] [MainThread]: Flushing usage events
[0m17:44:02.242079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:06.770363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071266c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107126750>]}


============================== 17:44:06.772618 | cd4857ac-62b3-46d5-83e8-0760b7d6277d ==============================
[0m17:44:06.772618 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:44:06.772857 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'warn_error': 'None', 'empty': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'static_parser': 'True', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/Users/angus/.dbt', 'printer_width': '80', 'fail_fast': 'False'}
[0m17:44:08.015548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c67e0>]}
[0m17:44:08.041482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e482330>]}
[0m17:44:08.041711 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:44:08.140761 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:44:08.193405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:44:08.193669 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/staging/member_G1.sql
[0m17:44:08.193806 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/marts/stats_G1.sql
[0m17:44:08.193930 [debug] [MainThread]: Partial parsing: updated file: dbt_demo://models/view/stats_G1_24M11.sql
[0m17:44:08.359173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee95190>]}
[0m17:44:08.387412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:44:08.388521 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:44:08.399504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2cce00>]}
[0m17:44:08.399692 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:44:08.399818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ee94b30>]}
[0m17:44:08.400514 [info ] [MainThread]: 
[0m17:44:08.400645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:08.400737 [info ] [MainThread]: 
[0m17:44:08.400911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:44:08.402247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m17:44:08.402395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:08.941462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_dev)
[0m17:44:08.942143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:09.156453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ed97110>]}
[0m17:44:09.157335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:09.162039 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:44:09.162720 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_dev.member_G1 ................................. [RUN]
[0m17:44:09.163191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:44:09.163545 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:44:09.173884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:44:09.174962 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:44:09.191466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:09.391578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m17:44:09.392339 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

 

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m17:44:09.856181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:46502f09-4e6e-44e0-bfca-4612d83bf988&page=queryresults
[0m17:44:19.849847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f97be90>]}
[0m17:44:19.850522 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_dev.member_G1 ............................ [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 10.68s]
[0m17:44:19.850963 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:44:19.851243 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:44:19.851611 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_dev.member_P221 ................................ [RUN]
[0m17:44:19.852001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:44:19.852231 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:44:19.854347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:44:19.855014 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:44:19.867415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m17:44:19.867920 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m17:44:19.868133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:20.184272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:fde8d4c2-2e3e-4be4-8898-feb58c3c92cc&page=queryresults
[0m17:44:20.438232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16551b6e0>]}
[0m17:44:20.439306 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_dev.member_P221 ........................... [[32mCREATE VIEW (0 processed)[0m in 0.59s]
[0m17:44:20.439970 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:44:20.440396 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m17:44:20.440966 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_dev.stats_G1 .................................. [RUN]
[0m17:44:20.441490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m17:44:20.441864 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m17:44:20.445691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m17:44:20.446551 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m17:44:20.449189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:20.603203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1"
[0m17:44:20.604918 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.stats_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
      
    
    

    
    OPTIONS()
    as (
       

select date_trunc(date, month) month_date, substring(phones,9,1) second_last_digit, count(distinct MID) counts
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1` 
group by month_date, second_last_digit
    );
  
[0m17:44:20.894755 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:0ec16f5a-f5f7-4c0f-9ef0-9d77e3a9f6fa&page=queryresults
[0m17:44:23.131036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655189e0>]}
[0m17:44:23.131977 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_dev.stats_G1 ............................. [[32mCREATE TABLE (312.0 rows, 31.2 KiB processed)[0m in 2.69s]
[0m17:44:23.132675 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m17:44:23.133571 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m17:44:23.134153 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_dev.stats_G1_24M11 ............................. [RUN]
[0m17:44:23.134636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now model.dbt_demo.stats_G1_24M11)
[0m17:44:23.135009 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m17:44:23.138499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m17:44:23.139256 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m17:44:23.142115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1_24M11"
[0m17:44:23.142760 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1_24M11: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "model.dbt_demo.stats_G1_24M11"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
  OPTIONS()
  as  

select second_last_digit, counts
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1` 
where month_date = "2024-11-1";


[0m17:44:23.143050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:23.430476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:92c940ce-141b-48da-888f-2ff4bcc9a784&page=queryresults
[0m17:44:23.647055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd4857ac-62b3-46d5-83e8-0760b7d6277d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654c90a0>]}
[0m17:44:23.648209 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_dev.stats_G1_24M11 ........................ [[32mCREATE VIEW (0 processed)[0m in 0.51s]
[0m17:44:23.649040 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m17:44:23.650356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:23.650999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:23.651305 [debug] [MainThread]: Connection 'model.dbt_demo.stats_G1_24M11' was properly closed.
[0m17:44:23.651702 [info ] [MainThread]: 
[0m17:44:23.652061 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m17:44:23.653261 [debug] [MainThread]: Command end result
[0m17:44:23.674368 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:44:23.675754 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:44:23.680224 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:44:23.680448 [info ] [MainThread]: 
[0m17:44:23.680673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:23.680831 [info ] [MainThread]: 
[0m17:44:23.681002 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:44:23.682595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.944313, "process_in_blocks": "0", "process_kernel_time": 0.754731, "process_mem_max_rss": "428687360", "process_out_blocks": "0", "process_user_time": 4.420484}
[0m17:44:23.682866 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:23.682815 after 16.94 seconds
[0m17:44:23.683082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d164b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e70c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791fe60>]}
[0m17:44:23.683272 [debug] [MainThread]: Flushing usage events
[0m17:44:24.513924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:45.256798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c42db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f2690>]}


============================== 17:47:45.259200 | 1459dabf-6ad9-44a9-9f0b-13b780a6d756 ==============================
[0m17:47:45.259200 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:47:45.259448 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt test', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/Users/angus/.dbt', 'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs'}
[0m17:47:46.600803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b3d1340>]}
[0m17:47:46.626451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17174b170>]}
[0m17:47:46.626697 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:47:46.724455 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:47:46.776168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:46.776319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:46.790979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172657b90>]}
[0m17:47:46.819217 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:47:46.820091 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:47:46.833868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dae08f0>]}
[0m17:47:46.834047 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:47:46.834175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172655eb0>]}
[0m17:47:46.834962 [info ] [MainThread]: 
[0m17:47:46.835100 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:46.835191 [info ] [MainThread]: 
[0m17:47:46.835370 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:47:46.836741 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:47:46.836850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:47.127663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1459dabf-6ad9-44a9-9f0b-13b780a6d756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdcd10>]}
[0m17:47:47.128483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:47.133102 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:47:47.133626 [info ] [Thread-1 (]: 1 of 12 START test not_null_member_G1_MID ...................................... [RUN]
[0m17:47:47.134105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:47:47.134443 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:47:47.149080 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:47:47.149863 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:47:47.161282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:47:47.161658 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:47:47.161854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:48.170525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e984e949-614f-452e-a44d-aa3c6ff10766&page=queryresults
[0m17:47:48.567369 [info ] [Thread-1 (]: 1 of 12 PASS not_null_member_G1_MID ............................................ [[32mPASS[0m in 1.43s]
[0m17:47:48.567757 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:47:48.567955 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:47:48.568184 [info ] [Thread-1 (]: 2 of 12 START test not_null_member_G1_date ..................................... [RUN]
[0m17:47:48.568437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:47:48.568607 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:47:48.570799 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:47:48.571127 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:47:48.572173 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:47:48.572446 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:47:48.572616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:49.146729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:737a7773-8fdb-47fb-98cf-b522fcffab15&page=queryresults
[0m17:47:49.444392 [info ] [Thread-1 (]: 2 of 12 PASS not_null_member_G1_date ........................................... [[32mPASS[0m in 0.88s]
[0m17:47:49.445237 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:47:49.445679 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:47:49.446128 [info ] [Thread-1 (]: 3 of 12 START test not_null_member_G1_phones ................................... [RUN]
[0m17:47:49.446598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:47:49.446946 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:47:49.452760 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:47:49.454072 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:47:49.456416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:47:49.457016 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:47:49.457327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:50.522947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:b6f1a9cf-54e3-4763-8b6a-53aebcd3c54d&page=queryresults
[0m17:47:50.868768 [info ] [Thread-1 (]: 3 of 12 PASS not_null_member_G1_phones ......................................... [[32mPASS[0m in 1.42s]
[0m17:47:50.869832 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:47:50.870376 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:47:50.870900 [info ] [Thread-1 (]: 4 of 12 START test not_null_member_P221_MID .................................... [RUN]
[0m17:47:50.871477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m17:47:50.871880 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:47:50.877965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:47:50.880245 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:47:50.883755 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:47:50.884905 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_MID.528f4abc43: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_MID.528f4abc43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where MID is null



  
  
      
    ) dbt_internal_test
[0m17:47:50.885367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:52.468653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:bb8e88cb-73a9-4598-b83c-6acd452aeb29&page=queryresults
[0m17:47:52.737618 [info ] [Thread-1 (]: 4 of 12 PASS not_null_member_P221_MID .......................................... [[32mPASS[0m in 1.87s]
[0m17:47:52.738594 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:47:52.739039 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:47:52.739496 [info ] [Thread-1 (]: 5 of 12 START test not_null_member_P221_date ................................... [RUN]
[0m17:47:52.740081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m17:47:52.740504 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:47:52.745890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:47:52.747023 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:47:52.749815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:47:52.750651 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_date.0430b9cd72: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_date.0430b9cd72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where date is null



  
  
      
    ) dbt_internal_test
[0m17:47:52.751019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:53.553615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:c25ef0da-3839-4e9b-bfb6-7ab82dd1a144&page=queryresults
[0m17:47:53.817361 [info ] [Thread-1 (]: 5 of 12 PASS not_null_member_P221_date ......................................... [[32mPASS[0m in 1.08s]
[0m17:47:53.817744 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:47:53.817931 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:47:53.818139 [info ] [Thread-1 (]: 6 of 12 START test not_null_member_P221_phones ................................. [RUN]
[0m17:47:53.818392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m17:47:53.818562 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:47:53.821638 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:47:53.822054 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:47:53.823182 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:47:53.823484 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
where phones is null



  
  
      
    ) dbt_internal_test
[0m17:47:53.823650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:55.046067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:961030d9-6843-4a90-9789-91b942b916cf&page=queryresults
[0m17:47:55.247171 [info ] [Thread-1 (]: 6 of 12 PASS not_null_member_P221_phones ....................................... [[32mPASS[0m in 1.43s]
[0m17:47:55.248106 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:47:55.248570 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:47:55.249003 [info ] [Thread-1 (]: 7 of 12 START test not_null_stats_G1_24M11_second_last_digit ................... [RUN]
[0m17:47:55.249519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m17:47:55.249905 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:47:55.255524 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:47:55.256656 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:47:55.259713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:47:55.260713 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m17:47:55.261129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.052364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:d2b053e5-870a-48b0-a5c6-84e6dc6c1dd3&page=queryresults
[0m17:47:56.263143 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stats_G1_24M11_second_last_digit ......................... [[32mPASS[0m in 1.01s]
[0m17:47:56.264162 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:47:56.264647 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:47:56.265100 [info ] [Thread-1 (]: 8 of 12 START test not_null_stats_G1_month_date ................................ [RUN]
[0m17:47:56.265642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m17:47:56.266025 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:47:56.272181 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:47:56.273263 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:47:56.276329 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:47:56.277258 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_date
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
where month_date is null



  
  
      
    ) dbt_internal_test
[0m17:47:56.277663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:56.769296 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:50725079-772a-47e2-b6dc-6d1d718fd729&page=queryresults
[0m17:47:57.008026 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stats_G1_month_date ...................................... [[32mPASS[0m in 0.74s]
[0m17:47:57.009059 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:47:57.009558 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:47:57.010019 [info ] [Thread-1 (]: 9 of 12 START test not_null_stats_G1_second_last_digit ......................... [RUN]
[0m17:47:57.010583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m17:47:57.010989 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:47:57.017105 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:47:57.018307 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:47:57.021674 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:47:57.022864 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m17:47:57.023241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:57.402016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7a5c571f-439d-4937-8a2f-8350e165138e&page=queryresults
[0m17:47:57.612374 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stats_G1_second_last_digit ............................... [[32mPASS[0m in 0.60s]
[0m17:47:57.613309 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:47:57.613766 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:47:57.614213 [info ] [Thread-1 (]: 10 of 12 START test unique_member_G1_MID ....................................... [RUN]
[0m17:47:57.614757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:47:57.615142 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:47:57.623734 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:47:57.624810 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:47:57.629533 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:47:57.630310 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:57.630711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:58.715091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8d4b7d62-6050-43b9-b6ab-b0058b4b759c&page=queryresults
[0m17:47:58.956154 [info ] [Thread-1 (]: 10 of 12 PASS unique_member_G1_MID ............................................. [[32mPASS[0m in 1.34s]
[0m17:47:58.956846 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:47:58.957293 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:47:58.957649 [info ] [Thread-1 (]: 11 of 12 START test unique_member_P221_MID ..................................... [RUN]
[0m17:47:58.958003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m17:47:58.958188 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:47:58.959972 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:47:58.960333 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:47:58.961280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:47:58.961540 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_P221_MID.a77105e8ee: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_member_P221_MID.a77105e8ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`member_P221`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:47:58.961686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:00.660627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:3884c8cd-b3ce-4784-b555-a84ece6e9e6f&page=queryresults
[0m17:48:01.003306 [info ] [Thread-1 (]: 11 of 12 PASS unique_member_P221_MID ........................................... [[32mPASS[0m in 2.04s]
[0m17:48:01.004258 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:48:01.004713 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:01.005166 [info ] [Thread-1 (]: 12 of 12 START test unique_stats_G1_24M11_second_last_digit .................... [RUN]
[0m17:48:01.005677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m17:48:01.006066 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:01.012418 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:48:01.013519 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:01.016495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:48:01.017608 [debug] [Thread-1 (]: On test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "node_id": "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select second_last_digit as unique_field
  from `tw-rd-data-angus-tu`.`dbt_dev`.`stats_G1_24M11`
  where second_last_digit is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:48:01.018175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:01.750462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:a33c0a4b-90ed-43d8-a955-12ead22f468d&page=queryresults
[0m17:48:02.143943 [info ] [Thread-1 (]: 12 of 12 PASS unique_stats_G1_24M11_second_last_digit .......................... [[32mPASS[0m in 1.14s]
[0m17:48:02.144907 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:02.146714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:02.147512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:02.147839 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m17:48:02.148183 [info ] [MainThread]: 
[0m17:48:02.148533 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m17:48:02.150716 [debug] [MainThread]: Command end result
[0m17:48:02.173118 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:48:02.174687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:48:02.179413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:48:02.179609 [info ] [MainThread]: 
[0m17:48:02.179835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:02.179984 [info ] [MainThread]: 
[0m17:48:02.180168 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m17:48:02.182071 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 16.955513, "process_in_blocks": "0", "process_kernel_time": 0.950284, "process_mem_max_rss": "418988032", "process_out_blocks": "0", "process_user_time": 4.40192}
[0m17:48:02.182372 [debug] [MainThread]: Command `dbt test` succeeded at 17:48:02.182310 after 16.96 seconds
[0m17:48:02.182614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108152150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d9cffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d9cfc50>]}
[0m17:48:02.182822 [debug] [MainThread]: Flushing usage events
[0m17:48:03.177528 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:06.899692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fa7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fa420>]}


============================== 17:48:06.901841 | bd6b4dad-b3b4-4150-8cc1-6b5c73198175 ==============================
[0m17:48:06.901841 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:48:06.902075 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/angus/.dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'invocation_command': 'dbt docs generate', 'version_check': 'True', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m17:48:08.067344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110934770>]}
[0m17:48:08.092488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110073470>]}
[0m17:48:08.092712 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:48:08.191778 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m17:48:08.243945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:08.244096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:08.258936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15645bb00>]}
[0m17:48:08.268300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156a65bb0>]}
[0m17:48:08.268470 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m17:48:08.268602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156093920>]}
[0m17:48:08.269342 [info ] [MainThread]: 
[0m17:48:08.269476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:08.269572 [info ] [MainThread]: 
[0m17:48:08.269738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:08.271011 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_dev'
[0m17:48:08.271141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:08.505811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd6b4dad-b3b4-4150-8cc1-6b5c73198175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1563b9490>]}
[0m17:48:08.506198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:08.508873 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m17:48:08.509199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_dev, now model.dbt_demo.member_G1)
[0m17:48:08.509455 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m17:48:08.517326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m17:48:08.517832 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m17:48:08.518144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.518662 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m17:48:08.518899 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m17:48:08.519167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m17:48:08.519436 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m17:48:08.521142 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m17:48:08.521482 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m17:48:08.521655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.522037 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m17:48:08.522223 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m17:48:08.522422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m17:48:08.522617 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m17:48:08.524194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m17:48:08.524500 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m17:48:08.524664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.525079 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m17:48:08.525267 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:48:08.525459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m17:48:08.525641 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:48:08.531239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m17:48:08.531523 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:48:08.531667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.531971 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m17:48:08.532124 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:48:08.532279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m17:48:08.532418 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:48:08.534117 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m17:48:08.534360 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:48:08.534500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.534915 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m17:48:08.535081 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:48:08.535245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m17:48:08.535386 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:48:08.537165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m17:48:08.537401 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:48:08.537540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.537828 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m17:48:08.537970 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:48:08.538115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m17:48:08.538246 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:48:08.540736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m17:48:08.540970 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:48:08.541102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.541388 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m17:48:08.541530 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:48:08.541667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m17:48:08.541795 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:48:08.543377 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m17:48:08.543597 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:48:08.543725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.543999 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m17:48:08.544135 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:48:08.544338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m17:48:08.544471 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:48:08.545944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m17:48:08.546160 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:48:08.546280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.546535 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m17:48:08.546669 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:48:08.546799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m17:48:08.546920 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:48:08.549048 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m17:48:08.549255 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:48:08.549372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.549613 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m17:48:08.549738 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:48:08.549863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m17:48:08.549978 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:48:08.551315 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m17:48:08.551496 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:48:08.551612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.551855 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m17:48:08.551984 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m17:48:08.552112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now model.dbt_demo.stats_G1_24M11)
[0m17:48:08.552229 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m17:48:08.553252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m17:48:08.553453 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m17:48:08.553571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.553808 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m17:48:08.553938 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:48:08.554076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1_24M11, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m17:48:08.554249 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:48:08.555607 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m17:48:08.555807 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:48:08.555925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.556159 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m17:48:08.556281 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:48:08.556401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m17:48:08.556513 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:48:08.557795 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m17:48:08.557981 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:48:08.558094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.558326 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m17:48:08.558445 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:48:08.558567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m17:48:08.558679 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:48:08.559975 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m17:48:08.560173 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:48:08.560288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.560518 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m17:48:08.560638 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:08.560757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m17:48:08.560868 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:08.562143 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m17:48:08.562326 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:08.562435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:08.562659 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m17:48:08.563013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:08.563122 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m17:48:08.563868 [debug] [MainThread]: Command end result
[0m17:48:08.593667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:48:08.594327 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:48:08.596495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m17:48:08.597751 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m17:48:08.597839 [info ] [MainThread]: Building catalog
[0m17:48:08.599404 [debug] [ThreadPool]: Acquiring new bigquery connection 'tw-rd-data-angus-tu.information_schema'
[0m17:48:08.606138 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dbt_dev`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('member_P221')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('stats_G1')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('stats_G1_24M11')
                            ) or (
                                upper(table_schema) = upper('dbt_dev')
                            and upper(table_name) = upper('member_G1')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dbt_dev`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:48:08.606439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:08.918744 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:c188e98d-5b95-4b0a-a99a-9fc575d37938&page=queryresults
[0m17:48:10.179811 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "dev", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dataform`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataform')
                            and upper(table_name) = upper('member')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m17:48:10.180912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:10.503577 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:077104c7-8116-480a-83d9-1c355c80a73f&page=queryresults
[0m17:48:11.797925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:11.808951 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m17:48:11.824967 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m17:48:11.825923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m17:48:11.826087 [info ] [MainThread]: Catalog written to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m17:48:11.827499 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.9571466, "process_in_blocks": "0", "process_kernel_time": 0.383985, "process_mem_max_rss": "415760384", "process_out_blocks": "0", "process_user_time": 4.457502}
[0m17:48:11.827838 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:48:11.827772 after 4.96 seconds
[0m17:48:11.828007 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:48:11.828154 [debug] [MainThread]: Connection 'tw-rd-data-angus-tu.information_schema' was properly closed.
[0m17:48:11.828324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fa510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156ad5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bc54c0>]}
[0m17:48:11.828500 [debug] [MainThread]: Flushing usage events
[0m17:48:12.675609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:48:22.815591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059af380>]}


============================== 17:48:22.817328 | e3069195-2b35-4a6d-8e61-c5530b0d0e3e ==============================
[0m17:48:22.817328 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m17:48:22.817564 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve --port 8088', 'static_parser': 'True', 'debug': 'False', 'empty': 'None', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/angus/.dbt', 'fail_fast': 'False', 'partial_parse': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m17:48:23.780761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3069195-2b35-4a6d-8e61-c5530b0d0e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e6b13d0>]}
[0m17:48:23.806268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3069195-2b35-4a6d-8e61-c5530b0d0e3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d57b200>]}
[0m11:12:08.513518 [error] [MainThread]: Encountered an error:

[0m11:12:08.523792 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:12:08.552436 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 11508.637, "process_in_blocks": "0", "process_kernel_time": 0.76102, "process_mem_max_rss": "398901248", "process_out_blocks": "0", "process_user_time": 4.969971}
[0m11:12:08.554865 [debug] [MainThread]: Command `dbt docs serve` failed at 11:12:08.554720 after 11508.64 seconds
[0m11:12:08.555681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059af6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e74cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14e7b88c0>]}
[0m11:12:08.556145 [debug] [MainThread]: Flushing usage events
[0m11:12:09.753306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:25.352297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aff2de0>]}


============================== 11:14:25.354778 | 334c57cd-d75b-4561-acb6-da2cea701201 ==============================
[0m11:14:25.354778 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:14:25.355025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/angus/.dbt', 'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --target prod', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs'}
[0m11:14:28.657969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a8e2690>]}
[0m11:14:28.683793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4e360>]}
[0m11:14:28.684043 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:14:28.799528 [debug] [MainThread]: checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, vars: {}, profile: , target: prod, version: 1.11.0b3
[0m11:14:28.833535 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:14:28.833751 [debug] [MainThread]: previous checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, current checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349
[0m11:14:28.833864 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:14:28.833955 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:14:28.834075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a66b080>]}
[0m11:14:29.285537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16da62b40>]}
[0m11:14:29.312275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:14:29.313293 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:14:29.322640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dcddcd0>]}
[0m11:14:29.322816 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m11:14:29.322941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16dc3b1d0>]}
[0m11:14:29.323636 [info ] [MainThread]: 
[0m11:14:29.323760 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:14:29.323856 [info ] [MainThread]: 
[0m11:14:29.324024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:14:29.325380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m11:14:29.325516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:29.822756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now create_tw-rd-data-angus-tu_dbt_prod)
[0m11:14:29.823657 [debug] [ThreadPool]: Creating schema "database: "tw-rd-data-angus-tu"
schema: "dbt_prod"
"
[0m11:14:29.834491 [debug] [ThreadPool]: On create_tw-rd-data-angus-tu_dbt_prod: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "connection_name": "create_tw-rd-data-angus-tu_dbt_prod"} */
create schema if not exists `tw-rd-data-angus-tu`.`dbt_prod`
  
[0m11:14:29.834947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:30.188627 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e8da739f-b4f3-4a24-9492-39a459098b50&page=queryresults
[0m11:14:31.826590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_tw-rd-data-angus-tu_dbt_prod, now list_tw-rd-data-angus-tu_dbt_prod)
[0m11:14:31.826966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:31.991898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bfb6b70>]}
[0m11:14:31.992899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:31.997466 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m11:14:31.998202 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_prod.member_G1 ................................ [RUN]
[0m11:14:31.998702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_prod, now model.dbt_demo.member_G1)
[0m11:14:31.999069 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m11:14:32.009349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m11:14:32.010577 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m11:14:32.039265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m11:14:32.039925 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

 

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m11:14:32.040160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:32.428006 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:fec0354f-fcc4-4b47-a8cc-ece9898f424e&page=queryresults
[0m11:14:40.834263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164e8ed50>]}
[0m11:14:40.835151 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_prod.member_G1 ........................... [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 8.83s]
[0m11:14:40.835651 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m11:14:40.835971 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m11:14:40.836384 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_prod.member_P221 ............................... [RUN]
[0m11:14:40.836769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m11:14:40.837033 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m11:14:40.839574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m11:14:40.840271 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m11:14:40.853707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m11:14:40.854427 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m11:14:40.854662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:41.435193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:5bfd0f51-8c03-4b8b-a447-81475b94d234&page=queryresults
[0m11:14:41.719288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17755a360>]}
[0m11:14:41.720511 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_prod.member_P221 .......................... [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m11:14:41.721200 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m11:14:41.721636 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m11:14:41.722182 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_prod.stats_G1 ................................. [RUN]
[0m11:14:41.722738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m11:14:41.723166 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m11:14:41.727810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m11:14:41.729949 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m11:14:41.735338 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1"
[0m11:14:41.736384 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
      
    
    

    
    OPTIONS()
    as (
       

select date_trunc(date, month) month_date, substring(phones,9,1) second_last_digit, count(distinct MID) counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1` 
group by month_date, second_last_digit
    );
  
[0m11:14:41.736786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:42.039443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:fdecb6dd-c355-4659-af1b-140add97b6bb&page=queryresults
[0m11:14:43.942988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177573e30>]}
[0m11:14:43.944186 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_prod.stats_G1 ............................ [[32mCREATE TABLE (312.0 rows, 31.2 KiB processed)[0m in 2.22s]
[0m11:14:43.945207 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m11:14:43.946250 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m11:14:43.946853 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_prod.stats_G1_24M11 ............................ [RUN]
[0m11:14:43.947367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now model.dbt_demo.stats_G1_24M11)
[0m11:14:43.947757 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m11:14:43.952316 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m11:14:43.953621 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m11:14:43.957358 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1_24M11"
[0m11:14:43.957985 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1_24M11: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1_24M11"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
  OPTIONS()
  as  

select second_last_digit, counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1` 
where month_date = "2024-11-1";


[0m11:14:43.958416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:44.261537 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f95c2514-e58d-4cc6-bcf9-702cda38f53d&page=queryresults
[0m11:14:44.438114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '334c57cd-d75b-4561-acb6-da2cea701201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x177573e30>]}
[0m11:14:44.439051 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_prod.stats_G1_24M11 ....................... [[32mCREATE VIEW (0 processed)[0m in 0.49s]
[0m11:14:44.439715 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m11:14:44.441072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:14:44.441798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:44.442097 [debug] [MainThread]: Connection 'model.dbt_demo.stats_G1_24M11' was properly closed.
[0m11:14:44.442503 [info ] [MainThread]: 
[0m11:14:44.442845 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.12 seconds (15.12s).
[0m11:14:44.443944 [debug] [MainThread]: Command end result
[0m11:14:44.577205 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:14:44.578183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:14:44.580399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m11:14:44.580532 [info ] [MainThread]: 
[0m11:14:44.580675 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:44.580784 [info ] [MainThread]: 
[0m11:14:44.580895 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:14:44.581787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.262852, "process_in_blocks": "0", "process_kernel_time": 0.678155, "process_mem_max_rss": "429883392", "process_out_blocks": "0", "process_user_time": 5.334228}
[0m11:14:44.581953 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:44.581922 after 19.26 seconds
[0m11:14:44.582079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164c08350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a232780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc8710>]}
[0m11:14:44.582195 [debug] [MainThread]: Flushing usage events
[0m11:14:45.451901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:48.953441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10813f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a047b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdfa40>]}


============================== 11:14:48.955757 | ca0f3105-3983-41cc-b0b1-d947855acd8b ==============================
[0m11:14:48.955757 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:14:48.956022 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --target prod', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/Users/angus/.dbt', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'warn_error': 'None'}
[0m11:14:50.244476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a28a750>]}
[0m11:14:50.269973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c0ef290>]}
[0m11:14:50.270214 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:14:50.370028 [debug] [MainThread]: checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, vars: {}, profile: , target: prod, version: 1.11.0b3
[0m11:14:50.421530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:50.421679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:50.436295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c6dbc50>]}
[0m11:14:50.464262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:14:50.464965 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:14:50.478766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ba37c20>]}
[0m11:14:50.478967 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m11:14:50.479102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c65ecf0>]}
[0m11:14:50.479889 [info ] [MainThread]: 
[0m11:14:50.480016 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:14:50.480110 [info ] [MainThread]: 
[0m11:14:50.480297 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:14:50.481708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_prod'
[0m11:14:50.481842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:50.768916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0f3105-3983-41cc-b0b1-d947855acd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf8590>]}
[0m11:14:50.769713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:14:50.773617 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:14:50.774047 [info ] [Thread-1 (]: 1 of 12 START test not_null_member_G1_MID ...................................... [RUN]
[0m11:14:50.774439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_prod, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m11:14:50.774723 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:14:50.789441 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m11:14:50.790310 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:14:50.801417 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m11:14:50.802078 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m11:14:50.802284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:51.713821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:85a29e39-116e-42cd-a002-660969835056&page=queryresults
[0m11:14:52.046008 [info ] [Thread-1 (]: 1 of 12 PASS not_null_member_G1_MID ............................................ [[32mPASS[0m in 1.27s]
[0m11:14:52.046715 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:14:52.047052 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:14:52.047445 [info ] [Thread-1 (]: 2 of 12 START test not_null_member_G1_date ..................................... [RUN]
[0m11:14:52.047877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m11:14:52.048181 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:14:52.051918 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m11:14:52.053455 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:14:52.055693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m11:14:52.056743 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:14:52.057103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:52.497962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f32811d5-8605-42e1-9d9c-3828cd6e72b9&page=queryresults
[0m11:14:52.760745 [info ] [Thread-1 (]: 2 of 12 PASS not_null_member_G1_date ........................................... [[32mPASS[0m in 0.71s]
[0m11:14:52.761779 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:14:52.762287 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:14:52.762796 [info ] [Thread-1 (]: 3 of 12 START test not_null_member_G1_phones ................................... [RUN]
[0m11:14:52.763329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m11:14:52.763713 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:14:52.769726 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m11:14:52.770917 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:14:52.774103 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m11:14:52.775150 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m11:14:52.775554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:53.538650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:56763272-cd3b-463d-aacc-a56eca3b8f27&page=queryresults
[0m11:14:53.826869 [info ] [Thread-1 (]: 3 of 12 PASS not_null_member_G1_phones ......................................... [[32mPASS[0m in 1.06s]
[0m11:14:53.827893 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:14:53.828364 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:14:53.828806 [info ] [Thread-1 (]: 4 of 12 START test not_null_member_P221_MID .................................... [RUN]
[0m11:14:53.829371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m11:14:53.829782 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:14:53.835387 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m11:14:53.837319 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:14:53.839929 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m11:14:53.840847 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_MID.528f4abc43: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_MID.528f4abc43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where MID is null



  
  
      
    ) dbt_internal_test
[0m11:14:53.841180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:55.190651 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:3ca1f056-6622-4efb-ba4e-a166a5f4d72b&page=queryresults
[0m11:14:55.426761 [info ] [Thread-1 (]: 4 of 12 PASS not_null_member_P221_MID .......................................... [[32mPASS[0m in 1.60s]
[0m11:14:55.427660 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:14:55.428103 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:14:55.428533 [info ] [Thread-1 (]: 5 of 12 START test not_null_member_P221_date ................................... [RUN]
[0m11:14:55.429114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m11:14:55.429532 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:14:55.435193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m11:14:55.436196 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:14:55.438872 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m11:14:55.439735 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_date.0430b9cd72: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_date.0430b9cd72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:14:55.440168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:56.295065 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:b5a40104-a586-4987-a302-314a9bbe0c2a&page=queryresults
[0m11:14:56.521572 [info ] [Thread-1 (]: 5 of 12 PASS not_null_member_P221_date ......................................... [[32mPASS[0m in 1.09s]
[0m11:14:56.522536 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:14:56.522995 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:14:56.523485 [info ] [Thread-1 (]: 6 of 12 START test not_null_member_P221_phones ................................. [RUN]
[0m11:14:56.524064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m11:14:56.524468 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:14:56.529842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m11:14:56.530823 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:14:56.536322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m11:14:56.537271 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where phones is null



  
  
      
    ) dbt_internal_test
[0m11:14:56.537662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:57.613767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:efd95f6b-be09-4944-80f1-933b9ab598bb&page=queryresults
[0m11:14:57.882022 [info ] [Thread-1 (]: 6 of 12 PASS not_null_member_P221_phones ....................................... [[32mPASS[0m in 1.36s]
[0m11:14:57.882900 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:14:57.883303 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:14:57.883699 [info ] [Thread-1 (]: 7 of 12 START test not_null_stats_G1_24M11_second_last_digit ................... [RUN]
[0m11:14:57.884193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m11:14:57.884544 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:14:57.889647 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m11:14:57.890974 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:14:57.893973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m11:14:57.894787 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m11:14:57.895147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:58.553619 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:80538425-321b-4a6d-8d88-c8f9b14f4e5c&page=queryresults
[0m11:14:58.782929 [info ] [Thread-1 (]: 7 of 12 PASS not_null_stats_G1_24M11_second_last_digit ......................... [[32mPASS[0m in 0.90s]
[0m11:14:58.783774 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:14:58.784267 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:14:58.784705 [info ] [Thread-1 (]: 8 of 12 START test not_null_stats_G1_month_date ................................ [RUN]
[0m11:14:58.785252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m11:14:58.785640 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:14:58.791003 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m11:14:58.791930 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:14:58.795274 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m11:14:58.796437 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_date
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
where month_date is null



  
  
      
    ) dbt_internal_test
[0m11:14:58.797188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:59.200176 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:0263321d-3777-4fd2-a481-ef2cd471c189&page=queryresults
[0m11:14:59.436158 [info ] [Thread-1 (]: 8 of 12 PASS not_null_stats_G1_month_date ...................................... [[32mPASS[0m in 0.65s]
[0m11:14:59.437135 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:14:59.437631 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:14:59.438086 [info ] [Thread-1 (]: 9 of 12 START test not_null_stats_G1_second_last_digit ......................... [RUN]
[0m11:14:59.438645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m11:14:59.439031 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:14:59.444913 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m11:14:59.446126 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:14:59.449143 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m11:14:59.450328 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m11:14:59.450816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:59.913288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:83a3b2f5-1ebe-476a-9085-ecb11c4ad19e&page=queryresults
[0m11:15:00.139742 [info ] [Thread-1 (]: 9 of 12 PASS not_null_stats_G1_second_last_digit ............................... [[32mPASS[0m in 0.70s]
[0m11:15:00.140680 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:15:00.141146 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:00.141594 [info ] [Thread-1 (]: 10 of 12 START test unique_member_G1_MID ....................................... [RUN]
[0m11:15:00.142128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m11:15:00.142508 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:00.150427 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m11:15:00.152130 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:00.154513 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m11:15:00.155065 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:15:00.155358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:00.937941 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:c16065a6-b795-4eca-9d17-f3e9da8e009e&page=queryresults
[0m11:15:01.217192 [info ] [Thread-1 (]: 10 of 12 PASS unique_member_G1_MID ............................................. [[32mPASS[0m in 1.07s]
[0m11:15:01.218234 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:01.218670 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:01.219072 [info ] [Thread-1 (]: 11 of 12 START test unique_member_P221_MID ..................................... [RUN]
[0m11:15:01.219550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m11:15:01.219877 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:01.227646 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m11:15:01.228580 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:01.230737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m11:15:01.231341 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_P221_MID.a77105e8ee: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_member_P221_MID.a77105e8ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:15:01.231651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:02.250639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:3958dc97-3206-45b7-9546-68b585726cf2&page=queryresults
[0m11:15:02.462902 [info ] [Thread-1 (]: 11 of 12 PASS unique_member_P221_MID ........................................... [[32mPASS[0m in 1.24s]
[0m11:15:02.463869 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:02.464328 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:02.464776 [info ] [Thread-1 (]: 12 of 12 START test unique_stats_G1_24M11_second_last_digit .................... [RUN]
[0m11:15:02.465315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m11:15:02.465701 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:02.471496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m11:15:02.472683 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:02.475662 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m11:15:02.476776 [debug] [Thread-1 (]: On test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select second_last_digit as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
  where second_last_digit is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:15:02.477284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:03.055782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:97cc0804-a616-4db6-929c-23a802695e76&page=queryresults
[0m11:15:03.247998 [info ] [Thread-1 (]: 12 of 12 PASS unique_stats_G1_24M11_second_last_digit .......................... [[32mPASS[0m in 0.78s]
[0m11:15:03.249018 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:03.250438 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:03.251114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:03.251421 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m11:15:03.251751 [info ] [MainThread]: 
[0m11:15:03.252082 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 12.77 seconds (12.77s).
[0m11:15:03.254021 [debug] [MainThread]: Command end result
[0m11:15:03.278369 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:15:03.279894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:15:03.284917 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m11:15:03.285179 [info ] [MainThread]: 
[0m11:15:03.285405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:03.285566 [info ] [MainThread]: 
[0m11:15:03.285731 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m11:15:03.287272 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 14.364117, "process_in_blocks": "0", "process_kernel_time": 0.731883, "process_mem_max_rss": "418791424", "process_out_blocks": "0", "process_user_time": 4.654447}
[0m11:15:03.287568 [debug] [MainThread]: Command `dbt test` succeeded at 11:15:03.287509 after 14.36 seconds
[0m11:15:03.287792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2884d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f572270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdfa40>]}
[0m11:15:03.287989 [debug] [MainThread]: Flushing usage events
[0m11:15:04.145622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:05.778625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ceb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa3c0>]}


============================== 11:15:05.780836 | 4c3166ad-06cf-499c-a052-1855650874be ==============================
[0m11:15:05.780836 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:15:05.781067 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt docs generate --target prod', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '/Users/angus/.dbt', 'printer_width': '80'}
[0m11:15:06.983655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1549e39b0>]}
[0m11:15:07.009320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155328980>]}
[0m11:15:07.009571 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:15:07.108927 [debug] [MainThread]: checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, vars: {}, profile: , target: prod, version: 1.11.0b3
[0m11:15:07.159413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:07.159567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:07.174390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15551b890>]}
[0m11:15:07.184035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155dbbd10>]}
[0m11:15:07.184207 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m11:15:07.184332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155c1bdd0>]}
[0m11:15:07.185069 [info ] [MainThread]: 
[0m11:15:07.185201 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:15:07.185295 [info ] [MainThread]: 
[0m11:15:07.185451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:15:07.186745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu_dbt_prod'
[0m11:15:07.186890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:07.426701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c3166ad-06cf-499c-a052-1855650874be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ddac90>]}
[0m11:15:07.427058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:07.429516 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m11:15:07.429860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_prod, now model.dbt_demo.member_G1)
[0m11:15:07.430109 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m11:15:07.436741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m11:15:07.437150 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m11:15:07.437349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.437773 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m11:15:07.437966 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m11:15:07.438228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m11:15:07.438515 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m11:15:07.441082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m11:15:07.441456 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m11:15:07.441644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.442041 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m11:15:07.442231 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m11:15:07.442437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m11:15:07.442635 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m11:15:07.444232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m11:15:07.444507 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m11:15:07.444659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.444980 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m11:15:07.445148 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:15:07.445324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m11:15:07.445568 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:15:07.451217 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m11:15:07.451484 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:15:07.451631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.451935 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:15:07.452086 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:15:07.452251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m11:15:07.452389 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:15:07.454088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m11:15:07.454337 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:15:07.454478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.454785 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:15:07.454942 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:15:07.455098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m11:15:07.455319 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:15:07.456929 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m11:15:07.457159 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:15:07.457295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.457569 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:15:07.457709 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:07.457848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m11:15:07.457981 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:07.460385 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m11:15:07.460607 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:07.460735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.461002 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:15:07.461141 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:15:07.461280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m11:15:07.461407 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:15:07.462870 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m11:15:07.463062 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:15:07.463184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.463440 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:15:07.463570 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:15:07.463706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m11:15:07.463827 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:15:07.465314 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m11:15:07.465521 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:15:07.465643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.465892 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:15:07.466019 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:15:07.466152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m11:15:07.466271 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:15:07.467663 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m11:15:07.467861 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:15:07.467983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.468228 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:15:07.468349 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:07.468474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m11:15:07.468591 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:07.470592 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m11:15:07.470781 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:07.470897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.471138 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:15:07.471264 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m11:15:07.471388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now model.dbt_demo.stats_G1_24M11)
[0m11:15:07.471502 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m11:15:07.472507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m11:15:07.472713 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m11:15:07.472829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.473065 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m11:15:07.473189 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:15:07.473337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1_24M11, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m11:15:07.473453 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:15:07.474801 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m11:15:07.474992 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:15:07.475108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.475340 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:15:07.475461 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:15:07.475579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m11:15:07.475691 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:15:07.476971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m11:15:07.477162 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:15:07.477278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.477504 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:15:07.477626 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:15:07.477747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m11:15:07.477860 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:15:07.479135 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m11:15:07.479317 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:15:07.479430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.479663 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:15:07.479791 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:07.479936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m11:15:07.480092 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:07.481545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m11:15:07.481759 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:07.481876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:07.482172 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:15:07.482531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:07.482643 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m11:15:07.483391 [debug] [MainThread]: Command end result
[0m11:15:07.513075 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:15:07.513787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:15:07.515939 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m11:15:07.517309 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:15:07.517399 [info ] [MainThread]: Building catalog
[0m11:15:07.519002 [debug] [ThreadPool]: Acquiring new bigquery connection 'tw-rd-data-angus-tu.information_schema'
[0m11:15:07.526014 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dbt_prod`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dbt_prod`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dbt_prod`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_prod')
                            and upper(table_name) = upper('member_P221')
                            ) or (
                                upper(table_schema) = upper('dbt_prod')
                            and upper(table_name) = upper('stats_G1')
                            ) or (
                                upper(table_schema) = upper('dbt_prod')
                            and upper(table_name) = upper('stats_G1_24M11')
                            ) or (
                                upper(table_schema) = upper('dbt_prod')
                            and upper(table_name) = upper('member_G1')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dbt_prod`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dbt_prod`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:15:07.526355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:07.821916 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:203d94e4-b158-4e9e-b478-fe12fc717fdc&page=queryresults
[0m11:15:08.845627 [debug] [ThreadPool]: On tw-rd-data-angus-tu.information_schema: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "connection_name": "tw-rd-data-angus-tu.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `tw-rd-data-angus-tu`.`dataform`.__TABLES__ tables
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dataform')
                            and upper(table_name) = upper('member')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMNS columns
    join `tw-rd-data-angus-tu`.`dataform`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m11:15:08.846641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:09.108968 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:e79760f7-5b74-4a4e-b022-54821d093818&page=queryresults
[0m11:15:10.062009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:10.073980 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m11:15:10.089987 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:15:10.090905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:15:10.091068 [info ] [MainThread]: Catalog written to /Users/angus/Documents/file/dbt_demo/target/catalog.json
[0m11:15:10.092322 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.343397, "process_in_blocks": "0", "process_kernel_time": 0.601298, "process_mem_max_rss": "415318016", "process_out_blocks": "0", "process_user_time": 4.200501}
[0m11:15:10.092614 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:15:10.092563 after 4.34 seconds
[0m11:15:10.092784 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:15:10.092921 [debug] [MainThread]: Connection 'tw-rd-data-angus-tu.information_schema' was properly closed.
[0m11:15:10.093077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100916b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fa4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f9df0>]}
[0m11:15:10.093236 [debug] [MainThread]: Flushing usage events
[0m11:15:10.920923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:13.618401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d15430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114eaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114eab40>]}


============================== 11:15:13.620210 | b85049c0-4743-4cb2-ad80-346779eb26b9 ==============================
[0m11:15:13.620210 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:15:13.620452 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True', 'no_print': 'None', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/angus/.dbt', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'log_format': 'default', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt docs serve --port 8088', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'empty': 'None'}
[0m11:15:14.645893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b85049c0-4743-4cb2-ad80-346779eb26b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x309c33b30>]}
[0m11:15:14.672462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b85049c0-4743-4cb2-ad80-346779eb26b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308a82960>]}
[0m11:15:49.980727 [error] [MainThread]: Encountered an error:

[0m11:15:49.987613 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/angus/Documents/file/venv/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:15:49.991121 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 36.401333, "process_in_blocks": "0", "process_kernel_time": 0.858691, "process_mem_max_rss": "399507456", "process_out_blocks": "0", "process_user_time": 3.480428}
[0m11:15:49.993111 [debug] [MainThread]: Command `dbt docs serve` failed at 11:15:49.992989 after 36.40 seconds
[0m11:15:49.993773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104251c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x308dffc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x309c57b90>]}
[0m11:15:49.994243 [debug] [MainThread]: Flushing usage events
[0m11:15:50.853965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:49.270583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d36de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f22b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a90f6e0>]}


============================== 11:41:49.273180 | d5af47ce-7609-4d73-bb5d-4fac5048e87c ==============================
[0m11:41:49.273180 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:41:49.273422 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'empty': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/angus/.dbt', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --target prod', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m11:41:50.619208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b58290>]}
[0m11:41:50.644347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d7d8b0>]}
[0m11:41:50.644580 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:41:50.745529 [debug] [MainThread]: checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, vars: {}, profile: , target: prod, version: 1.11.0b3
[0m11:41:50.778124 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:41:50.778326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a1fab70>]}
[0m11:41:51.231014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a830cb0>]}
[0m11:41:51.257710 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:41:51.258716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:41:51.268864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a8af1d0>]}
[0m11:41:51.269039 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m11:41:51.269161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a47e6f0>]}
[0m11:41:51.269830 [info ] [MainThread]: 
[0m11:41:51.269952 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:41:51.270042 [info ] [MainThread]: 
[0m11:41:51.270207 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:41:51.271712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m11:41:51.271832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:51.804901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_prod)
[0m11:41:51.805662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:52.069748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a40f350>]}
[0m11:41:52.070240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:52.132067 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m11:41:52.132308 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_prod.member_G1 ................................ [RUN]
[0m11:41:52.132479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_prod, now model.dbt_demo.member_G1)
[0m11:41:52.132602 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m11:41:52.135938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m11:41:52.136401 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m11:41:52.145170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:52.399387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m11:41:52.400889 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

 

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m11:41:52.780021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:255b57f6-b156-428d-882b-e9bd7797278a&page=queryresults
[0m11:42:03.202845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15407b920>]}
[0m11:42:03.203641 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_prod.member_G1 ........................... [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 11.07s]
[0m11:42:03.204039 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m11:42:03.204290 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m11:42:03.204645 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_prod.member_P221 ............................... [RUN]
[0m11:42:03.205000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m11:42:03.205199 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m11:42:03.207351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m11:42:03.207992 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m11:42:03.218394 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m11:42:03.218841 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m11:42:03.219022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:03.670883 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:2160a12a-2450-4371-a849-bfb9b824f6c0&page=queryresults
[0m11:42:03.879858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159c3d460>]}
[0m11:42:03.881042 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_prod.member_P221 .......................... [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m11:42:03.881734 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m11:42:03.882189 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m11:42:03.882727 [info ] [Thread-1 (]: 3 of 4 START sql table model dbt_prod.stats_G1 ................................. [RUN]
[0m11:42:03.883192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now model.dbt_demo.stats_G1)
[0m11:42:03.883552 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m11:42:03.888328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m11:42:03.890025 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m11:42:03.892274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:04.182942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1"
[0m11:42:04.184381 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
      
    
    

    
    OPTIONS()
    as (
       

select date_trunc(date, month) month_date, substring(phones,9,1) second_last_digit, count(distinct MID) counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1` 
group by month_date, second_last_digit
    );
  
[0m11:42:04.499382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f903d63c-61ca-4312-a87d-977e4ddb241e&page=queryresults
[0m11:42:06.770186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15407b920>]}
[0m11:42:06.771095 [info ] [Thread-1 (]: 3 of 4 OK created sql table model dbt_prod.stats_G1 ............................ [[32mCREATE TABLE (312.0 rows, 31.2 KiB processed)[0m in 2.89s]
[0m11:42:06.771696 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m11:42:06.772405 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m11:42:06.772804 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_prod.stats_G1_24M11 ............................ [RUN]
[0m11:42:06.773230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now model.dbt_demo.stats_G1_24M11)
[0m11:42:06.773619 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m11:42:06.776728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m11:42:06.777514 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m11:42:06.780199 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1_24M11"
[0m11:42:06.780859 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1_24M11: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1_24M11"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
  OPTIONS()
  as  

select second_last_digit, counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1` 
where month_date = "2024-11-1";


[0m11:42:06.781201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:07.245597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7aa2dd77-261b-43f8-9435-b23d408fb3f5&page=queryresults
[0m11:42:07.436429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5af47ce-7609-4d73-bb5d-4fac5048e87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161236990>]}
[0m11:42:07.437463 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_prod.stats_G1_24M11 ....................... [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m11:42:07.438108 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m11:42:07.439496 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:07.506253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:07.506453 [debug] [MainThread]: Connection 'model.dbt_demo.stats_G1_24M11' was properly closed.
[0m11:42:07.506613 [info ] [MainThread]: 
[0m11:42:07.506743 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 16.24 seconds (16.24s).
[0m11:42:07.507147 [debug] [MainThread]: Command end result
[0m11:42:07.605521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:42:07.606279 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:42:07.608863 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m11:42:07.608994 [info ] [MainThread]: 
[0m11:42:07.609135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:07.609236 [info ] [MainThread]: 
[0m11:42:07.609343 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m11:42:07.610200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.372831, "process_in_blocks": "0", "process_kernel_time": 0.403058, "process_mem_max_rss": "425639936", "process_out_blocks": "0", "process_user_time": 5.548545}
[0m11:42:07.610354 [debug] [MainThread]: Command `dbt run` succeeded at 11:42:07.610325 after 18.37 seconds
[0m11:42:07.610473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a805fa0>]}
[0m11:42:07.610585 [debug] [MainThread]: Flushing usage events
[0m11:42:08.551036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:06.931572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fe960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fe600>]}


============================== 11:44:06.934133 | bc1e328a-112b-4a0e-99f2-a3740d184164 ==============================
[0m11:44:06.934133 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m11:44:06.934384 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'False', 'quiet': 'False', 'static_parser': 'True', 'invocation_command': 'dbt build --target prod', 'warn_error': 'None', 'profiles_dir': '/Users/angus/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'log_path': '/Users/angus/Documents/file/dbt_demo/logs', 'log_format': 'default', 'use_colors': 'True'}
[0m11:44:08.285122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170a59100>]}
[0m11:44:08.310790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a4a10>]}
[0m11:44:08.311072 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m11:44:08.410967 [debug] [MainThread]: checksum: 31a353112452aeb3afecfcaa077a794211369b98bb862c7429a460e8ccbb46b3, vars: {}, profile: , target: prod, version: 1.11.0b3
[0m11:44:08.467312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:08.467496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:08.482551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170cdb1a0>]}
[0m11:44:08.511030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:44:08.512093 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:44:08.527924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f3b98e0>]}
[0m11:44:08.528124 [info ] [MainThread]: Found 4 models, 12 data tests, 1 source, 508 macros
[0m11:44:08.529096 [info ] [MainThread]: 
[0m11:44:08.529239 [info ] [MainThread]: Concurrency: 1 threads (target='prod')
[0m11:44:08.529334 [info ] [MainThread]: 
[0m11:44:08.529518 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:44:08.530832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_tw-rd-data-angus-tu'
[0m11:44:08.530974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:09.106395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu, now list_tw-rd-data-angus-tu_dbt_prod)
[0m11:44:09.106677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:09.371346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1709ce1e0>]}
[0m11:44:09.371626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:09.416955 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_G1
[0m11:44:09.417164 [info ] [Thread-1 (]: 1 of 16 START sql table model dbt_prod.member_G1 ............................... [RUN]
[0m11:44:09.417400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_tw-rd-data-angus-tu_dbt_prod, now model.dbt_demo.member_G1)
[0m11:44:09.417516 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_G1
[0m11:44:09.421000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_G1"
[0m11:44:09.421276 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_G1
[0m11:44:09.429987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:09.685964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_G1"
[0m11:44:09.686548 [debug] [Thread-1 (]: On model.dbt_demo.member_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
      
    partition by date
    

    
    OPTIONS()
    as (
      --  -- can omit (same as dbt_project.yml)

 

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%1'
    );
  
[0m11:44:10.130167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8db09fc2-808e-4fcf-93ea-b1d9d94f73c0&page=queryresults
[0m11:44:19.898508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170cf7f20>]}
[0m11:44:19.899395 [info ] [Thread-1 (]: 1 of 16 OK created sql table model dbt_prod.member_G1 .......................... [[32mCREATE TABLE (1.0k rows, 303.1 KiB processed)[0m in 10.48s]
[0m11:44:19.900358 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_G1
[0m11:44:19.900791 [debug] [Thread-1 (]: Began running node model.dbt_demo.member_P221
[0m11:44:19.901328 [info ] [Thread-1 (]: 2 of 16 START sql view model dbt_prod.member_P221 .............................. [RUN]
[0m11:44:19.901827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_G1, now model.dbt_demo.member_P221)
[0m11:44:19.902132 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.member_P221
[0m11:44:19.904763 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.member_P221"
[0m11:44:19.905413 [debug] [Thread-1 (]: Began executing node model.dbt_demo.member_P221
[0m11:44:19.919265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.member_P221"
[0m11:44:19.919841 [debug] [Thread-1 (]: On model.dbt_demo.member_P221: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.member_P221"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
  OPTIONS()
  as  

select *
from `tw-rd-data-angus-tu`.`dataform`.`member`
where phones like '%221';


[0m11:44:19.920056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:20.314334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8201e247-2589-4542-becb-ee61d77bec7c&page=queryresults
[0m11:44:20.504242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1726ea150>]}
[0m11:44:20.505471 [info ] [Thread-1 (]: 2 of 16 OK created sql view model dbt_prod.member_P221 ......................... [[32mCREATE VIEW (0 processed)[0m in 0.60s]
[0m11:44:20.506211 [debug] [Thread-1 (]: Finished running node model.dbt_demo.member_P221
[0m11:44:20.506646 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:44:20.507261 [info ] [Thread-1 (]: 3 of 16 START test not_null_member_G1_MID ...................................... [RUN]
[0m11:44:20.507999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.member_P221, now test.dbt_demo.not_null_member_G1_MID.ec46057d33)
[0m11:44:20.508412 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:44:20.520317 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m11:44:20.521139 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:44:20.532966 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_MID.ec46057d33"
[0m11:44:20.533743 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_MID.ec46057d33: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_MID.ec46057d33"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where MID is null



  
  
      
    ) dbt_internal_test
[0m11:44:20.534056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:21.625922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:7abd6222-ca44-4703-89cb-c68a79fcd44f&page=queryresults
[0m11:44:21.963455 [info ] [Thread-1 (]: 3 of 16 PASS not_null_member_G1_MID ............................................ [[32mPASS[0m in 1.46s]
[0m11:44:21.964123 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_MID.ec46057d33
[0m11:44:21.964449 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:44:21.964832 [info ] [Thread-1 (]: 4 of 16 START test not_null_member_G1_date ..................................... [RUN]
[0m11:44:21.965272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_MID.ec46057d33, now test.dbt_demo.not_null_member_G1_date.d263364d67)
[0m11:44:21.965546 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:44:21.969247 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m11:44:21.969951 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:44:21.971878 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_date.d263364d67"
[0m11:44:21.972608 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_date.d263364d67: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_date.d263364d67"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:44:21.973048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:22.520557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:078d79ce-004c-4a68-beca-dd53bd146145&page=queryresults
[0m11:44:22.885156 [info ] [Thread-1 (]: 4 of 16 PASS not_null_member_G1_date ........................................... [[32mPASS[0m in 0.92s]
[0m11:44:22.885973 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_date.d263364d67
[0m11:44:22.886423 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:44:22.886805 [info ] [Thread-1 (]: 5 of 16 START test not_null_member_G1_phones ................................... [RUN]
[0m11:44:22.887204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_date.d263364d67, now test.dbt_demo.not_null_member_G1_phones.48d39869aa)
[0m11:44:22.887523 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:44:22.895224 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m11:44:22.896202 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:44:22.899295 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_G1_phones.48d39869aa"
[0m11:44:22.900229 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_G1_phones.48d39869aa: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_G1_phones.48d39869aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
where phones is null



  
  
      
    ) dbt_internal_test
[0m11:44:22.900635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:24.054247 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:8f785cf2-e41a-409b-a1ee-4894a213e956&page=queryresults
[0m11:44:24.303804 [info ] [Thread-1 (]: 5 of 16 PASS not_null_member_G1_phones ......................................... [[32mPASS[0m in 1.42s]
[0m11:44:24.304410 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_G1_phones.48d39869aa
[0m11:44:24.304719 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:44:24.305081 [info ] [Thread-1 (]: 6 of 16 START test unique_member_G1_MID ........................................ [RUN]
[0m11:44:24.305642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_G1_phones.48d39869aa, now test.dbt_demo.unique_member_G1_MID.90461bb780)
[0m11:44:24.306172 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:44:24.311596 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m11:44:24.312213 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:44:24.314408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_G1_MID.90461bb780"
[0m11:44:24.315258 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_G1_MID.90461bb780: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_member_G1_MID.90461bb780"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:44:24.315527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:25.247807 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f0e6fa74-9e7b-45fe-83a6-83e59607731d&page=queryresults
[0m11:44:25.467237 [info ] [Thread-1 (]: 6 of 16 PASS unique_member_G1_MID .............................................. [[32mPASS[0m in 1.16s]
[0m11:44:25.468308 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_G1_MID.90461bb780
[0m11:44:25.468852 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:44:25.469391 [info ] [Thread-1 (]: 7 of 16 START test not_null_member_P221_MID .................................... [RUN]
[0m11:44:25.470240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_G1_MID.90461bb780, now test.dbt_demo.not_null_member_P221_MID.528f4abc43)
[0m11:44:25.470672 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:44:25.475350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m11:44:25.476287 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:44:25.479027 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_MID.528f4abc43"
[0m11:44:25.480252 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_MID.528f4abc43: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_MID.528f4abc43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select MID
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where MID is null



  
  
      
    ) dbt_internal_test
[0m11:44:25.480565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:26.727554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:939bb979-e9d6-4535-ae04-a0d7cbbee9c2&page=queryresults
[0m11:44:26.975156 [info ] [Thread-1 (]: 7 of 16 PASS not_null_member_P221_MID .......................................... [[32mPASS[0m in 1.50s]
[0m11:44:26.976125 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_MID.528f4abc43
[0m11:44:26.976562 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:44:26.977033 [info ] [Thread-1 (]: 8 of 16 START test not_null_member_P221_date ................................... [RUN]
[0m11:44:26.977605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_MID.528f4abc43, now test.dbt_demo.not_null_member_P221_date.0430b9cd72)
[0m11:44:26.977997 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:44:26.983753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m11:44:26.984465 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:44:26.987677 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_date.0430b9cd72"
[0m11:44:26.988692 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_date.0430b9cd72: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_date.0430b9cd72"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where date is null



  
  
      
    ) dbt_internal_test
[0m11:44:26.989101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:27.798921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:99024b0b-ee60-448f-955b-fd7f166df4c3&page=queryresults
[0m11:44:28.071390 [info ] [Thread-1 (]: 8 of 16 PASS not_null_member_P221_date ......................................... [[32mPASS[0m in 1.09s]
[0m11:44:28.072280 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_date.0430b9cd72
[0m11:44:28.072745 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:44:28.073185 [info ] [Thread-1 (]: 9 of 16 START test not_null_member_P221_phones ................................. [RUN]
[0m11:44:28.073807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_date.0430b9cd72, now test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8)
[0m11:44:28.074292 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:44:28.079868 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m11:44:28.080943 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:44:28.083733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"
[0m11:44:28.084759 [debug] [Thread-1 (]: On test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select phones
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
where phones is null



  
  
      
    ) dbt_internal_test
[0m11:44:28.085194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:29.364139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:60987278-f675-4895-9214-9cdce4684232&page=queryresults
[0m11:44:29.621634 [info ] [Thread-1 (]: 9 of 16 PASS not_null_member_P221_phones ....................................... [[32mPASS[0m in 1.55s]
[0m11:44:29.622573 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8
[0m11:44:29.623036 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:44:29.623487 [info ] [Thread-1 (]: 10 of 16 START test unique_member_P221_MID ..................................... [RUN]
[0m11:44:29.624023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_member_P221_phones.85ac0d5bc8, now test.dbt_demo.unique_member_P221_MID.a77105e8ee)
[0m11:44:29.624431 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:44:29.629965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m11:44:29.631000 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:44:29.633787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_member_P221_MID.a77105e8ee"
[0m11:44:29.634649 [debug] [Thread-1 (]: On test.dbt_demo.unique_member_P221_MID.a77105e8ee: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_member_P221_MID.a77105e8ee"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select MID as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`member_P221`
  where MID is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:44:29.635035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:31.123145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:673469d6-16b1-4e8f-99df-3992c887531b&page=queryresults
[0m11:44:31.435534 [info ] [Thread-1 (]: 10 of 16 PASS unique_member_P221_MID ........................................... [[32mPASS[0m in 1.81s]
[0m11:44:31.436437 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_member_P221_MID.a77105e8ee
[0m11:44:31.436891 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1
[0m11:44:31.437485 [info ] [Thread-1 (]: 11 of 16 START sql table model dbt_prod.stats_G1 ............................... [RUN]
[0m11:44:31.437989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.unique_member_P221_MID.a77105e8ee, now model.dbt_demo.stats_G1)
[0m11:44:31.438342 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1
[0m11:44:31.442735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1"
[0m11:44:31.444601 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1
[0m11:44:31.447282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:31.714029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1"
[0m11:44:31.715377 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1"} */

  
    

    create or replace table `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
      
    
    

    
    OPTIONS()
    as (
       

select date_trunc(date, month) month_date, substring(phones,9,1) second_last_digit, count(distinct MID) counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`member_G1` 
group by month_date, second_last_digit
    );
  
[0m11:44:32.043543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:ef1e8f06-9865-44a9-9c20-a606ca368e91&page=queryresults
[0m11:44:34.134502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1727f1b20>]}
[0m11:44:34.134902 [info ] [Thread-1 (]: 11 of 16 OK created sql table model dbt_prod.stats_G1 .......................... [[32mCREATE TABLE (312.0 rows, 31.2 KiB processed)[0m in 2.70s]
[0m11:44:34.135114 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1
[0m11:44:34.135394 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:44:34.135545 [info ] [Thread-1 (]: 12 of 16 START test not_null_stats_G1_month_date ............................... [RUN]
[0m11:44:34.135700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1, now test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1)
[0m11:44:34.135817 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:44:34.137470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m11:44:34.138158 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:44:34.139086 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"
[0m11:44:34.139344 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month_date
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
where month_date is null



  
  
      
    ) dbt_internal_test
[0m11:44:34.139486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:34.575270 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:f77b72c0-5357-4792-bbee-7145d57369e3&page=queryresults
[0m11:44:34.839034 [info ] [Thread-1 (]: 12 of 16 PASS not_null_stats_G1_month_date ..................................... [[32mPASS[0m in 0.70s]
[0m11:44:34.839383 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1
[0m11:44:34.839560 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:44:34.839768 [info ] [Thread-1 (]: 13 of 16 START test not_null_stats_G1_second_last_digit ........................ [RUN]
[0m11:44:34.840011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_month_date.ad2846f9e1, now test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93)
[0m11:44:34.840179 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:44:34.842147 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m11:44:34.842511 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:44:34.843507 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"
[0m11:44:34.843959 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m11:44:34.844132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:35.376283 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:6092c496-a791-4baf-b555-46ef19865485&page=queryresults
[0m11:44:35.620242 [info ] [Thread-1 (]: 13 of 16 PASS not_null_stats_G1_second_last_digit .............................. [[32mPASS[0m in 0.78s]
[0m11:44:35.620581 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93
[0m11:44:35.620937 [debug] [Thread-1 (]: Began running node model.dbt_demo.stats_G1_24M11
[0m11:44:35.621215 [info ] [Thread-1 (]: 14 of 16 START sql view model dbt_prod.stats_G1_24M11 .......................... [RUN]
[0m11:44:35.621449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_second_last_digit.8681614b93, now model.dbt_demo.stats_G1_24M11)
[0m11:44:35.621609 [debug] [Thread-1 (]: Began compiling node model.dbt_demo.stats_G1_24M11
[0m11:44:35.623035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_demo.stats_G1_24M11"
[0m11:44:35.623389 [debug] [Thread-1 (]: Began executing node model.dbt_demo.stats_G1_24M11
[0m11:44:35.625360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_demo.stats_G1_24M11"
[0m11:44:35.625626 [debug] [Thread-1 (]: On model.dbt_demo.stats_G1_24M11: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "model.dbt_demo.stats_G1_24M11"} */


  create or replace view `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
  OPTIONS()
  as  

select second_last_digit, counts
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1` 
where month_date = "2024-11-1";


[0m11:44:35.625772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:36.036130 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:fa89b4cf-0133-4a05-8fd8-e84c899604d8&page=queryresults
[0m11:44:36.216125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc1e328a-112b-4a0e-99f2-a3740d184164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17aa0d070>]}
[0m11:44:36.216674 [info ] [Thread-1 (]: 14 of 16 OK created sql view model dbt_prod.stats_G1_24M11 ..................... [[32mCREATE VIEW (0 processed)[0m in 0.59s]
[0m11:44:36.217082 [debug] [Thread-1 (]: Finished running node model.dbt_demo.stats_G1_24M11
[0m11:44:36.217597 [debug] [Thread-1 (]: Began running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:44:36.217931 [info ] [Thread-1 (]: 15 of 16 START test not_null_stats_G1_24M11_second_last_digit .................. [RUN]
[0m11:44:36.218204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_demo.stats_G1_24M11, now test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1)
[0m11:44:36.218421 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:44:36.221119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m11:44:36.221666 [debug] [Thread-1 (]: Began executing node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:44:36.223204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"
[0m11:44:36.223712 [debug] [Thread-1 (]: On test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select second_last_digit
from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
where second_last_digit is null



  
  
      
    ) dbt_internal_test
[0m11:44:36.223959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:37.061311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:c29e9c17-1876-4f5b-bc74-553c929e4241&page=queryresults
[0m11:44:37.256159 [info ] [Thread-1 (]: 15 of 16 PASS not_null_stats_G1_24M11_second_last_digit ........................ [[32mPASS[0m in 1.04s]
[0m11:44:37.256500 [debug] [Thread-1 (]: Finished running node test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1
[0m11:44:37.256670 [debug] [Thread-1 (]: Began running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:44:37.256848 [info ] [Thread-1 (]: 16 of 16 START test unique_stats_G1_24M11_second_last_digit .................... [RUN]
[0m11:44:37.257062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_demo.not_null_stats_G1_24M11_second_last_digit.0b8d6cbab1, now test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70)
[0m11:44:37.257212 [debug] [Thread-1 (]: Began compiling node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:44:37.258982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m11:44:37.259345 [debug] [Thread-1 (]: Began executing node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:44:37.260431 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"
[0m11:44:37.260735 [debug] [Thread-1 (]: On test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70: /* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "dbt_demo", "target_name": "prod", "node_id": "test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select second_last_digit as unique_field
  from `tw-rd-data-angus-tu`.`dbt_prod`.`stats_G1_24M11`
  where second_last_digit is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:44:37.260893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:37.935645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=tw-rd-data-angus-tu&j=bq:asia-east1:76eb4b95-688b-40e2-a309-7089b5a0dcf8&page=queryresults
[0m11:44:38.186386 [info ] [Thread-1 (]: 16 of 16 PASS unique_stats_G1_24M11_second_last_digit .......................... [[32mPASS[0m in 0.93s]
[0m11:44:38.186708 [debug] [Thread-1 (]: Finished running node test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70
[0m11:44:38.187204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:38.231220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:38.231415 [debug] [MainThread]: Connection 'test.dbt_demo.unique_stats_G1_24M11_second_last_digit.8079e95b70' was properly closed.
[0m11:44:38.231563 [info ] [MainThread]: 
[0m11:44:38.231691 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 2 view models in 0 hours 0 minutes and 29.70 seconds (29.70s).
[0m11:44:38.232497 [debug] [MainThread]: Command end result
[0m11:44:38.241005 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/angus/Documents/file/dbt_demo/target/manifest.json
[0m11:44:38.241880 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/angus/Documents/file/dbt_demo/target/semantic_manifest.json
[0m11:44:38.244510 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/angus/Documents/file/dbt_demo/target/run_results.json
[0m11:44:38.244663 [info ] [MainThread]: 
[0m11:44:38.244800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:38.244906 [info ] [MainThread]: 
[0m11:44:38.245020 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m11:44:38.245948 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 31.345938, "process_in_blocks": "0", "process_kernel_time": 0.42293, "process_mem_max_rss": "413843456", "process_out_blocks": "0", "process_user_time": 6.157761}
[0m11:44:38.246115 [debug] [MainThread]: Command `dbt build` succeeded at 11:44:38.246082 after 31.35 seconds
[0m11:44:38.246249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f4dd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063739e0>]}
[0m11:44:38.246365 [debug] [MainThread]: Flushing usage events
[0m11:44:39.103730 [debug] [MainThread]: An error was encountered while trying to flush usage events
